<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-contributors/getting-started" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>Contributing to Metals | Metals</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:image content=http://scalameta.org/metals/img/scalameta-logo.png /><meta data-rh=true name=twitter:image content=http://scalameta.org/metals/img/scalameta-logo.png /><meta data-rh=true property=og:url content=http://scalameta.org/metals/docs/contributors/getting-started /><meta data-rh=true property=og:locale content=en /><meta data-rh=true name=docusaurus_locale content=en /><meta data-rh=true name=docsearch:language content=en /><meta data-rh=true name=docusaurus_version content=current /><meta data-rh=true name=docusaurus_tag content=docs-default-current /><meta data-rh=true name=docsearch:version content=current /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current /><meta data-rh=true property=og:title content="Contributing to Metals | Metals"/><meta data-rh=true name=description content="Whenever you are stuck or unsure, please open an issue or [ask us on"/><meta data-rh=true property=og:description content="Whenever you are stuck or unsure, please open an issue or [ask us on"/><link data-rh=true rel=icon href=/metals/img/favicon.ico /><link data-rh=true rel=canonical href=http://scalameta.org/metals/docs/contributors/getting-started /><link data-rh=true rel=alternate href=http://scalameta.org/metals/docs/contributors/getting-started hreflang=en /><link data-rh=true rel=alternate href=http://scalameta.org/metals/docs/contributors/getting-started hreflang=x-default /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"http://scalameta.org/metals/docs/contributors/getting-started","name":"Contributing to Metals","position":1}]}</script><link rel=alternate type=application/rss+xml href=/metals/blog/rss.xml title="Metals RSS Feed"><link rel=alternate type=application/atom+xml href=/metals/blog/atom.xml title="Metals Atom Feed"><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140140828-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-140140828-1",{})</script><link rel=stylesheet href=/metals/assets/css/styles.0a68ebe2.css /><script src=/metals/assets/js/runtime~main.c5e0417f.js defer></script><script src=/metals/assets/js/main.90160155.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/metals/img/scalameta-logo.png /><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/metals/><div class=navbar__logo><img src=/metals/img/scalameta-logo.png alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/metals/img/scalameta-logo.png alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"/></div><b class="navbar__title text--truncate">Metals</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/metals/docs/>Docs</a><a class="navbar__item navbar__link" href=/metals/blog/>Blog</a><a href=https://github.com/scalameta/metals target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><div class="navbar__search searchBarContainer_NW3z" dir=ltr><input placeholder=Search aria-label=Search class="navbar__search-input searchInput_YFbd" value="" /><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/metals/docs/><span title="Text Editors" class=categoryLinkLabel_W154>Text Editors</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/metals/docs/features/codeactions><span title=Features class=categoryLinkLabel_W154>Features</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/metals/docs/build-tools/overview><span title="Build Tools" class=categoryLinkLabel_W154>Build Tools</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/metals/docs/contributors/project-goals><span title=Contributing class=categoryLinkLabel_W154>Contributing</span></a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/metals/docs/contributors/project-goals><span title="Project Goals" class=linkLabel_WmDU>Project Goals</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/metals/docs/contributors/getting-started><span title="Contributing to Metals" class=linkLabel_WmDU>Contributing to Metals</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/metals/docs/contributors/updating-website><span title="Contributing to the website" class=linkLabel_WmDU>Contributing to the website</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/metals/docs/contributors/releasing><span title="Making a release" class=linkLabel_WmDU>Making a release</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/metals/docs/integrations/new-build-tool><span title="Integrating with Metals" class=categoryLinkLabel_W154>Integrating with Metals</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/metals/docs/troubleshooting/proxy><span title=Troubleshooting class=categoryLinkLabel_W154>Troubleshooting</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/metals/docs/acknowledgements/development><span title=Acknowledgements class=categoryLinkLabel_W154>Acknowledgements</span></a></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/metals/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Contributing</span><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>Contributing to Metals</span></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Contributing to Metals</h1></header><p>Whenever you are stuck or unsure, please open an issue or <a href=https://discord.gg/DwTc8xbNDd target=_blank rel="noopener noreferrer" class="">ask us on
Discord</a>. This project
follows <a href=https://github.com/scalameta/scalameta/blob/master/CONTRIBUTING.md target=_blank rel="noopener noreferrer" class="">Scalameta's contribution
guidelines</a>
and the <a href=https://scala-lang.org/conduct/ target=_blank rel="noopener noreferrer" class="">Scala CoC</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=requirements>Requirements<a href=#requirements class=hash-link aria-label="Direct link to Requirements" title="Direct link to Requirements" translate=no>​</a></h2>
<p>You will need the following applications installed:</p>
<ul>
<li class="">Java 17</li>
<li class=""><code>git</code></li>
<li class=""><code>sbt</code> (for building a local version of the server)</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=project-structure>Project structure<a href=#project-structure class=hash-link aria-label="Direct link to Project structure" title="Direct link to Project structure" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=main-metals-project>Main Metals Project<a href=#main-metals-project class=hash-link aria-label="Direct link to Main Metals Project" title="Direct link to Main Metals Project" translate=no>​</a></h3>
<p>The main Metals module is located in the <code>metals</code> directory.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=entrypoint-to-the-metals-server>Entrypoint to the Metals Server<a href=#entrypoint-to-the-metals-server class=hash-link aria-label="Direct link to Entrypoint to the Metals Server" title="Direct link to Entrypoint to the Metals Server" translate=no>​</a></h4>
<p>The first LSP request (<code>initialize</code>) is handled by <code>MetalsLanguageServer</code>, which then instantiates <code>WorkspaceLspService</code> to manage all subsequent LSP requests. Acting as a dispatcher, <code>WorkspaceLspService</code> handles multiple projects within a single workspace by creating a separate <code>ProjectMetalsLspService</code> for each one and routing LSP queries accordingly. In addition to these project-specific services, there's a fallback service — <code>FallbackMetalsLspService</code> — responsible for handling standalone files. Shared logic between <code>ProjectMetalsLspService</code> and <code>FallbackMetalsLspService</code> is encapsulated in the <code>MetalsLspService</code> class.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=presentation-compiler>Presentation Compiler<a href=#presentation-compiler class=hash-link aria-label="Direct link to Presentation Compiler" title="Direct link to Presentation Compiler" translate=no>​</a></h3>
<p>Many of Metals features (e.g., go to references) work primarily using <a href=https://scalameta.org/docs/semanticdb/guide.html target=_blank rel="noopener noreferrer" class="">Semantic DB</a> -- semantic information produced during compilation. However, for actions, that require very up-to-date information, Metals uses presentation compiler (pc). Presentation compiler uses Scala (interactive) compiler, so it is published for a specific Scala version. Presentation compiler for Scala 2 is in the the cross-published <code>mtags</code> module in Metals, for Scala 3 in the <code>scala3-presentation-compiler</code> module in the <code>scala/scala3</code> repository.</p>
<p>Metals loads a presentation compiler instance for a module (build target) using the required Scala version. The interfaces for communication with presentation compiler are in <code>mtags-interfaces</code>, where <code>PresentationCompiler.java</code> is the presentation compiler API.</p>
<p>Additionally, Metals has a limited implementation of a presentation compiler for Java in <code>mtags-java</code>.</p>
<p>To avoid repetition, common utilities of presentation compilers are in <code>mtags-shared</code>. Since Scala 3 compiler cannot have dependencies on Scala projects, <code>mtags-shared</code> sources are currently automatically copied to the compiler repository.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=tests>Tests<a href=#tests class=hash-link aria-label="Direct link to Tests" title="Direct link to Tests" translate=no>​</a></h3>
<ul>
<li class=""><code>tests/unit</code> - moderately fast-running unit tests. Mostly contain LSP test, that use Bloop with a quick setup.</li>
<li class=""><code>tests/cross</code> - tests targeting cross builds for Scala 2 presentation compiler. Analogical tests for Scala 3 are in the compiler repository.</li>
<li class=""><code>tests/slow</code> - slow integration tests. Contain tests for different build tools and build servers. Mtags are cross published for slow tests, so LSP test for testing non-default Scala 2 versions should also go here.</li>
<li class=""><code>tests/input</code> - example Scala code that is used as testing data for unit tests.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=other-modules>Other modules<a href=#other-modules class=hash-link aria-label="Direct link to Other modules" title="Direct link to Other modules" translate=no>​</a></h3>
<ul>
<li class=""><code>sbt-metals</code> - the sbt plugin used when users are using the BSP support from
sbt to ensure semanticDB is being produced by sbt.</li>
<li class=""><code>docs</code> - documentation markdown for the Metals website.</li>
<li class=""><code>metals-docs</code> - methods used for generating documentation across multiple pages
in <code>docs</code>.</li>
<li class=""><code>website</code> - holds the static site configuration, style and blogs posts for the
Metals website.</li>
</ul>
<p>Below diagram shows project structure and dependencies among modules. Note that
<code>default-&lt;suffix></code> is a <a href=https://www.scala-sbt.org/1.x/docs/Multi-Project.html#Default+root+project target=_blank rel="noopener noreferrer" class="">default root project</a>
created implicitly by sbt.
<img decoding=async loading=lazy src="https://github.com/scalameta/gh-pages-images/blob/master/metals/getting-started/oIhXd5l.png?raw=true" alt="Projects diagram" class=img_ev3q /></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=related-projects>Related projects<a href=#related-projects class=hash-link aria-label="Direct link to Related projects" title="Direct link to Related projects" translate=no>​</a></h2>
<p>The improvement you are looking to contribute may belong in a separate
repository:</p>
<ul>
<li class=""><a href=https://github.com/scalameta/metals-vscode/ target=_blank rel="noopener noreferrer" class="">scalameta/metals-vscode</a>: the
Visual Studio Code extension for Metals.</li>
<li class=""><a href=https://github.com/scalameta/nvim-metals/ target=_blank rel="noopener noreferrer" class="">scalameta/nvim-metals</a>: the Neovim
extension for Metals using the built-in LSP support of Neovim.</li>
<li class=""><a href=https://github.com/scalameta/scalameta/ target=_blank rel="noopener noreferrer" class="">scalameta/scalameta</a>: SemanticDB for Scala 2,
parsing, tokenization.</li>
<li class=""><a href=https://github.com/scalameta/munit/ target=_blank rel="noopener noreferrer" class="">scalameta/munit</a>: Test framework used in
the main Metals repository</li>
<li class=""><a href=https://github.com/scalacenter/bloop/ target=_blank rel="noopener noreferrer" class="">scalacenter/bloop</a>: build server for
compilation.</li>
<li class=""><a href=https://github.com/scala/scala/ target=_blank rel="noopener noreferrer" class="">scala/scala</a>: Scala 2 interactive compiler.</li>
<li class=""><a href=https://github.com/lampepfl/dotty target=_blank rel="noopener noreferrer" class="">scala/scala3</a>: Scala 3 presentation
compiler, SemanticDB for Scala 3.</li>
<li class=""><a href=https://github.com/scalameta/scalafmt/ target=_blank rel="noopener noreferrer" class="">scalameta/scalafmt</a>: code formatting.</li>
<li class=""><a href=https://github.com/scalacenter/scalafix/ target=_blank rel="noopener noreferrer" class="">scalacenter/scalafix</a>: code
refactoring and linting.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=common-development-workflow>Common development workflow<a href=#common-development-workflow class=hash-link aria-label="Direct link to Common development workflow" title="Direct link to Common development workflow" translate=no>​</a></h2>
<p>Most of the time development in Metals looks like:</p>
<ul>
<li class="">do some changes</li>
<li class="">write tests which check if your changes work</li>
<li class="">publish Metals server locally and test changes manually</li>
</ul>
<p>When diving into part of the code without any prior knowledge it might be hard
to comprehend what's going on and what part of the code is responsible for
specific behavior. There are several ways to debug Metals, but most popular are:</p>
<ul>
<li class="">debugging through logging (recommended option)</li>
<li class="">classic debugging with breakpoints</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=commit-messages>Commit messages<a href=#commit-messages class=hash-link aria-label="Direct link to Commit messages" title="Direct link to Commit messages" translate=no>​</a></h2>
<p>Try to follow the
<a href=https://www.conventionalcommits.org/en/v1.0.0/ target=_blank rel="noopener noreferrer" class="">conventional commits specification</a>,
which means your commits should be of form:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain">&lt;type>[optional scope]: &lt;description></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">[optional body]</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">[optional footer(s)]</span><br/></span></code></pre></div></div>
<p>It's important to over-communicate in your commit messages. Be thorough. It's
important to ensure you outline the problem you're trying to solve, or the
feature you're introducing, and then explain the fix or implementation. This will
help the reviewers with their review and also future contributors to get the
full context of your changes.</p>
<p>For example, this message can be take a form of:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain">Previously, this bug was happening due to invalid handling of URIs. Now, we handle them correctly using a dedicated class.</span><br/></span></code></pre></div></div>
<p>Ideally, each PR would only have one commit and the title with body would be the
same for the pull requests. However, sometimes a PR might require more changes
and commits, in that case please try to keep them self contained, which means
each change pertains to a specific bug or feature and can be reverted
separately.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=debugging-through-logging>Debugging through logging<a href=#debugging-through-logging class=hash-link aria-label="Direct link to Debugging through logging" title="Direct link to Debugging through logging" translate=no>​</a></h3>
<p>This approach provides very quick iterations and short feedback loop.
It depends on placing multiple <code>pprint.log()</code> calls which will log
messages in <code>.metals.log</code> file. Logged output can be watched by <code>tail -f .metals/metals.log</code>.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain">MetalsLanguageServer.scala:1841 params: DebugSessionParams [</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  targets = SingletonList (</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    BuildTargetIdentifier [</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">      uri = "file:/HappyMetalsUser/metals/#metals/Compile"</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    ]</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  )</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  dataKind = "scala-attach-remote"</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  data = {}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">]</span><br/></span></code></pre></div></div>
<p>See <a href=#workspace-logs class="">workspace logs</a> for more information.</p>
<p>This approach can be used in 2 variants:</p>
<ul>
<li class="">together with <a href=#manual-tests class="">manual testing</a> when it's hard to write test
for some changes.</li>
<li class="">with <a href=#unit-tests class="">unit tests</a></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=classic-debugging>Classic debugging<a href=#classic-debugging class=hash-link aria-label="Direct link to Classic debugging" title="Direct link to Classic debugging" translate=no>​</a></h3>
<p>Classic debugging is possible by the <a href=#jvm-debugging class="">JVM debugging mechanism</a>.
Publish Metals locally, open a new project and configure debug settings.
Then you can attach IDE with opened Metals repository to the debugged instance:</p>
<ul>
<li class="">
<p>VSCode - add attach configuration to yours <a class="" href=/metals/docs/editors/vscode#via-a-launchjson-configuration>launch.json</a></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain">{</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  "version": "0.2.0",</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  "configurations": [</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    // Attach debugger when running via:</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    // `-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=localhost:5005`</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">      "type": "scala",</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">      "request": "attach",</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">      "name": "Attach debugger to Metals server",</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">      "buildTarget": "metals",</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">      "hostName": "localhost",</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">      "port": 5005</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    }</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  ]</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span></code></pre></div></div>
<p>Then pick such a defined configuration and run debug.</p>
<p><img decoding=async loading=lazy src="https://github.com/scalameta/gh-pages-images/blob/master/metals/getting-started/ySAo6Um.png?raw=true" alt="Attach debugger" class=img_ev3q /></p>
</li>
<li class="">
<p>IntelliJ - Select Attach to the process and pick proper process from the list</p>
<p><img decoding=async loading=lazy src="https://github.com/scalameta/gh-pages-images/blob/master/metals/getting-started/lHSl57l.png?raw=true" alt="Attach to the process" class=img_ev3q /></p>
</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=unit-tests>Unit tests<a href=#unit-tests class=hash-link aria-label="Direct link to Unit tests" title="Direct link to Unit tests" translate=no>​</a></h2>
<p>To run the unit tests open an sbt shell and run <code>unit/test</code>. However, this command will
run all of the unit tests declared in <code>unit</code> module.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain">sbt</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># (recommended) run a specific test suite, great for edit/test/debug workflows.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">> unit/testOnly tests.DefinitionSuite</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># run a specific test case inside the suite.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">> unit/testOnly tests.DefinitionSuite -- &lt;exact-test-name></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># run unit tests, moderately fast but still a bit too slow for edit/test/debug workflows.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">> unit/test</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># run slow integration tests, takes several minutes.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">> slow/test</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># (not recommended) run all tests, slow. It's better to target individual projects.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">> test</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=manually-testing-an-lspsuite>Manually testing an <code>LspSuite</code><a href=#manually-testing-an-lspsuite class=hash-link aria-label="Direct link to manually-testing-an-lspsuite" title="Direct link to manually-testing-an-lspsuite" translate=no>​</a></h3>
<p>Every test suite that extends <code>LspSuite</code> generates a workspace directory under
<code>tests/unit/target/e2e/&lt;suitename>/&lt;testname></code>. To debug why a <code>LspSuite</code> might be
failing, run the test once and then open it directly in the editor. For
example, for the test case <code>"deprecated-scala"</code> in <code>WarningsLspSuite</code> run the
following command:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain">code tests/unit/target/e2e/warnings/deprecated-scala</span><br/></span></code></pre></div></div>
<p>This will open Visual Studio Code in directory with test project and it'll be
possible to investigate why test is failing manually.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=cross-tests>Cross tests<a href=#cross-tests class=hash-link aria-label="Direct link to Cross tests" title="Direct link to Cross tests" translate=no>​</a></h2>
<p>Tests for Scala 2 presenatation compiler, check common features such as hover, completions or signatures.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain">sbt</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># run presentation compiler tests, these are the quickest tests to run.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">> cross/test</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># run presentation compiler tests for all Scala versions.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">> +cross/test</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=manual-tests>Manual tests<a href=#manual-tests class=hash-link aria-label="Direct link to Manual tests" title="Direct link to Manual tests" translate=no>​</a></h2>
<p>Some functionality is best to manually test through an editor. A common workflow
while iterating on a new feature is to run <code>publishLocal</code> and then open an
editor in a small demo build.</p>
<p>It's important to note that <code>sbt publishLocal</code> will create artifacts only for
the Scala version currently used in Metals and trying to use the snapshot
version with any other Scala version will not work. This may be fine if you're
working on a generic feature that isn't using the presentation compiler
(anything in mtags),  if not then you need to publish the specific version of
mtags that you're trying to test</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain">sbt</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">> publishLocal</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">> ++2.12.20 mtags/publishLocal</span><br/></span></code></pre></div></div>
<p>You can also do a full cross publish with <code>sbt +publishLocal</code>, however this will
take quite some time, so it's often better to only target the version you need.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=visual-studio-code>Visual Studio Code<a href=#visual-studio-code class=hash-link aria-label="Direct link to Visual Studio Code" title="Direct link to Visual Studio Code" translate=no>​</a></h3>
<p>Install the Metals extension from the Marketplace by searching for "Metals".</p>
<p><a href=vscode:extension/scalameta.metals target=_blank rel="noopener noreferrer" class="">Click here to install the Metals VS Code plugin</a></p>
<p>Next, update the "Server version" setting under preferences to point to the
version you published locally via <code>sbt publishLocal</code>. You'll notice that version has the format
<code>&lt;version>-SNAPSHOT</code>.</p>
<p><img decoding=async loading=lazy src="https://github.com/scalameta/gh-pages-images/blob/master/metals/getting-started/ogVWI1t.png?raw=true" alt="Metals server version setting" class=img_ev3q /></p>
<p>When you make changes in the Metals Scala codebase</p>
<ul>
<li class="">publish metals binary as described above.</li>
<li class="">execute the "Metals: Restart server" command in Visual Studio Code (via
command palette)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=vimneovim>Vim/Neovim<a href=#vimneovim class=hash-link aria-label="Direct link to Vim/Neovim" title="Direct link to Vim/Neovim" translate=no>​</a></h3>
<p>If using <code>nvim-metals</code>:</p>
<p>You'll want to make sure to read the docs
<a href=https://github.com/scalameta/nvim-metals/blob/main/doc/metals.txt target=_blank rel="noopener noreferrer" class="">here</a> and
take a look at the example configuration
<a href=https://github.com/scalameta/nvim-metals/discussions/39 target=_blank rel="noopener noreferrer" class="">here</a> if you haven't
already set everything up.</p>
<ul>
<li class="">publish the metals binary as described above.</li>
<li class="">set the <code>serverVersion</code> in your <code>settings</code> table that you pass in to your
metals config.</li>
<li class="">Open your workspace and trigger a <code>:MetalsUpdate</code> followed by a
<code>:MetalsRestart</code>. NOTE: that every time you publish locally you'll want to
trigger this again.</li>
</ul>
<p>If you are using another Vim client, write a <code>new-metals-vim</code> script that builds
a new <code>metals-vim</code> bootstrap script using the locally published version.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain">coursier bootstrap \</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --java-opt -Dmetals.client=&lt;&lt;NAME_OF_CLIENT>> \</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  org.scalameta:metals_2.13:1.6.4-SNAPSHOT \ # double-check version here</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  -o /usr/local/bin/metals-vim -f</span><br/></span></code></pre></div></div>
<p><strong>NOTE</strong> if you're able to configure your client using initialization options,
then the <code>client</code> property is not necessary. You can see all the options
<a href=https://scalameta.org/metals/docs/integrations/new-editor#initializationoptions target=_blank rel="noopener noreferrer" class="">here</a>.</p>
<p>Finally, start Vim with the local Metals version</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain">cd test-workspace # any directory you want to manually test Metals</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">new-metals-vim && vim build.sbt # remember to have the script in your $PATH</span><br/></span></code></pre></div></div>
<p>When you make changes in the Metals Scala codebase, run <code>sbt publishLocal</code>, quit
vim and re-run <code>new-metals-vim && vim build.sbt</code>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=workspace-logs>Workspace logs<a href=#workspace-logs class=hash-link aria-label="Direct link to Workspace logs" title="Direct link to Workspace logs" translate=no>​</a></h2>
<p>Metals logs workspace-specific information to the
<code>$WORKSPACE/.metals/metals.log</code> file.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain">tail -f .metals/metals.log</span><br/></span></code></pre></div></div>
<p>These logs contain information that may be relevant for regular users.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=json-rpc-trace>JSON-RPC trace<a href=#json-rpc-trace class=hash-link aria-label="Direct link to JSON-RPC trace" title="Direct link to JSON-RPC trace" translate=no>​</a></h2>
<p>To see the trace of incoming/outgoing JSON communication with the text editor
or build server, create empty files in <code>$WORKSPACE/.metals/</code> or your machine cache
directory.</p>
<p>However, we do not recommend using your machine cache directory because
trace files located there are shared between all Metals instances, hence multiple
servers can override the same file. Using <code>$WORKSPACE/.metals/</code> solves this issue and
also allows user to have more precise control over which metals instances log
their JSON-RPC communication.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain"># Linux and macOS</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">touch $WORKSPACE/.metals/lsp.trace.json # text editor</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">touch $WORKSPACE/.metals/bsp.trace.json # build server</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">touch $WORKSPACE/.metals/dap-server.trace.json # debug adapter</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">touch $WORKSPACE/.metals/dap-client.trace.json # debug adapter</span><br/></span></code></pre></div></div>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain"># Windows</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">type nul > $WORKSPACE/.metals/lsp.trace.json # text editor</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">type nul > $WORKSPACE/.metals/bsp.trace.json # build server</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">type nul > $WORKSPACE/.metals/dap-server.trace.json # debug adapter</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">type nul > $WORKSPACE/.metals/dap-client.trace.json # debug adapter</span><br/></span></code></pre></div></div>
<p>Next when you start Metals, watch the logs with <code>tail -f</code>.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain"># Linux and macOS</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">tail -f $WORKSPACE/.metals/lsp.trace.json</span><br/></span></code></pre></div></div>
<p>The traces are very verbose so it's recommended to delete the files if you are
not interested in debugging the JSON communication.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=jvm-debugging>JVM Debugging<a href=#jvm-debugging class=hash-link aria-label="Direct link to JVM Debugging" title="Direct link to JVM Debugging" translate=no>​</a></h2>
<p>To debug the JVM with the Metals server, add a property to your
<code>Server Properties</code> with the usual Java debugging flags, making sure you have
the <code>quiet</code> option on. It's important to remember about the flag, as the server
uses standard input/output to communicate with the client, and the default
output of the debugger interferes with that.</p>
<p>This property will make your server run in debug mode on port 5005 without
waiting for the debugger to connect:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain">-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005,quiet=y</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=updating-build-tool-launcherwrappers>Updating build tool launcher/wrappers<a href=#updating-build-tool-launcherwrappers class=hash-link aria-label="Direct link to Updating build tool launcher/wrappers" title="Direct link to Updating build tool launcher/wrappers" translate=no>​</a></h2>
<p>Metals uses various wrappers or launchers for each build tool that it supports.
This makes sure that when your in a workspace for you build tool that metals is
able to correctly launch that build tool, even if it doesn't exist on the users
<code>$PATH</code>. You can see their usages in <code>&lt;BuildToolName>BuildTool.scala</code>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=updating-sbt-launcher>Updating sbt-launcher<a href=#updating-sbt-launcher class=hash-link aria-label="Direct link to Updating sbt-launcher" title="Direct link to Updating sbt-launcher" translate=no>​</a></h3>
<p>The easiest way to update the sbt-launcher is with the following coursier
command:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain">cp "$(cs fetch org.scala-sbt:sbt-launch:&lt;version>)" sbt-launch.jar</span><br/></span></code></pre></div></div>
<p>This will allow you to not have to do some of the manual steps with the launcher
properties file listed <a href=https://github.com/sbt/launcher target=_blank rel="noopener noreferrer" class="">here</a>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=updating-maven-wrappers>Updating maven wrappers<a href=#updating-maven-wrappers class=hash-link aria-label="Direct link to Updating maven wrappers" title="Direct link to Updating maven wrappers" translate=no>​</a></h3>
<p>For Maven we use the <a href=https://maven.apache.org/wrapper/maven-wrapper/index.html target=_blank rel="noopener noreferrer" class="">Maven
Wrapper</a>. In order to
update this you'll want to do the following:</p>
<ul>
<li class="">Run the <code>./bin/update-maven-wrapper.sh</code> script</li>
<li class="">Update the <code>def version</code> in <code>MavenBuildTool.scala</code> to the latest version
that you just updated to.</li>
<li class="">Run the specific maven tests and ensure they pass: <code>./bin/test.sh   'slow/testOnly -- tests.maven.*'</code></li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=git-hooks>Git hooks<a href=#git-hooks class=hash-link aria-label="Direct link to Git hooks" title="Direct link to Git hooks" translate=no>​</a></h2>
<p>This git repository has a pre-push hook to run Scalafmt.</p>
<p>The CI also uses Scalafix to assert that there a no unused imports. To
automatically remove unused imports run <code>sbt scalafixAll</code>. We don't run Scalafix
as a pre-push git hook since starting sbt takes a long time.</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href=https://github.com/scalameta/metals/edit/main/docs/contributors/getting-started.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/metals/docs/contributors/project-goals><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Project Goals</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/metals/docs/contributors/updating-website><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Contributing to the website</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#requirements class="table-of-contents__link toc-highlight">Requirements</a><li><a href=#project-structure class="table-of-contents__link toc-highlight">Project structure</a><ul><li><a href=#main-metals-project class="table-of-contents__link toc-highlight">Main Metals Project</a><li><a href=#presentation-compiler class="table-of-contents__link toc-highlight">Presentation Compiler</a><li><a href=#tests class="table-of-contents__link toc-highlight">Tests</a><li><a href=#other-modules class="table-of-contents__link toc-highlight">Other modules</a></ul><li><a href=#related-projects class="table-of-contents__link toc-highlight">Related projects</a><li><a href=#common-development-workflow class="table-of-contents__link toc-highlight">Common development workflow</a><li><a href=#commit-messages class="table-of-contents__link toc-highlight">Commit messages</a><ul><li><a href=#debugging-through-logging class="table-of-contents__link toc-highlight">Debugging through logging</a><li><a href=#classic-debugging class="table-of-contents__link toc-highlight">Classic debugging</a></ul><li><a href=#unit-tests class="table-of-contents__link toc-highlight">Unit tests</a><ul><li><a href=#manually-testing-an-lspsuite class="table-of-contents__link toc-highlight">Manually testing an <code>LspSuite</code></a></ul><li><a href=#cross-tests class="table-of-contents__link toc-highlight">Cross tests</a><li><a href=#manual-tests class="table-of-contents__link toc-highlight">Manual tests</a><ul><li><a href=#visual-studio-code class="table-of-contents__link toc-highlight">Visual Studio Code</a><li><a href=#vimneovim class="table-of-contents__link toc-highlight">Vim/Neovim</a></ul><li><a href=#workspace-logs class="table-of-contents__link toc-highlight">Workspace logs</a><li><a href=#json-rpc-trace class="table-of-contents__link toc-highlight">JSON-RPC trace</a><li><a href=#jvm-debugging class="table-of-contents__link toc-highlight">JVM Debugging</a><li><a href=#updating-build-tool-launcherwrappers class="table-of-contents__link toc-highlight">Updating build tool launcher/wrappers</a><ul><li><a href=#updating-sbt-launcher class="table-of-contents__link toc-highlight">Updating sbt-launcher</a><li><a href=#updating-maven-wrappers class="table-of-contents__link toc-highlight">Updating maven wrappers</a></ul><li><a href=#git-hooks class="table-of-contents__link toc-highlight">Git hooks</a></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Overview</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/metals/docs/>Overview</a><li class=footer__item><a class=footer__link-item href=/metals/docs/build-tools/overview>Build Tools</a><li class=footer__item><a class=footer__link-item href=/metals/docs/contributors/project-goals>Project Goals</a><li class=footer__item><a class=footer__link-item href=/metals/docs/contributors/getting-started>Contributing</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Social</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/scalameta/metals target=_blank>
                      <img src="https://img.shields.io/github/stars/scalameta/metals.svg?color=%23087e8b&label=stars&logo=github&style=social"/>
                    </a><li class=footer__item><a href=https://discord.gg/RFpSVth target=_blank>
                      <img src="https://img.shields.io/discord/632642981228314653?logo=discord&style=social"/>
                    </a><li class=footer__item><a href=https://twitter.com/scalameta target=_blank>
                      <img src="https://img.shields.io/twitter/follow/scalameta.svg?logo=twitter&style=social"/>
                    </a></ul></div></div><div class="footer__bottom text--center"><div class=margin-bottom--sm><img src=/metals/img/scalameta-logo.png class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/metals/img/scalameta-logo.png class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"/></div><div class=footer__copyright>Copyright © 2025 Metals</div></div></div></footer></div></body>