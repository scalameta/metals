<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-integrations/debug-adapter-protocol" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>Running and debugging | Metals</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=http://scalameta.org/metals/img/scalameta-logo.png><meta data-rh=true name=twitter:image content=http://scalameta.org/metals/img/scalameta-logo.png><meta data-rh=true property=og:url content=http://scalameta.org/metals/docs/integrations/debug-adapter-protocol><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="Running and debugging | Metals"><meta data-rh=true name=description content="Metals implements the Debug Adapter Protocol, which can be used by the editor to"><meta data-rh=true property=og:description content="Metals implements the Debug Adapter Protocol, which can be used by the editor to"><link data-rh=true rel=icon href=/metals/img/favicon.ico><link data-rh=true rel=canonical href=http://scalameta.org/metals/docs/integrations/debug-adapter-protocol><link data-rh=true rel=alternate href=http://scalameta.org/metals/docs/integrations/debug-adapter-protocol hreflang=en><link data-rh=true rel=alternate href=http://scalameta.org/metals/docs/integrations/debug-adapter-protocol hreflang=x-default><link rel=alternate type=application/rss+xml href=/metals/blog/rss.xml title="Metals RSS Feed"><link rel=alternate type=application/atom+xml href=/metals/blog/atom.xml title="Metals Atom Feed"><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140140828-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-140140828-1",{})</script><link rel=stylesheet href=/metals/assets/css/styles.fce52a61.css><script src=/metals/assets/js/runtime~main.f48f305b.js defer></script><script src=/metals/assets/js/main.69098695.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":(window.matchMedia("(prefers-color-scheme: light)").matches,"light"),document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/metals/><div class=navbar__logo><img src=/metals/img/scalameta-logo.png alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/metals/img/scalameta-logo.png alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Metals</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/metals/docs/>Docs</a><a class="navbar__item navbar__link" href=/metals/blog/>Blog</a><a href=https://github.com/scalameta/metals target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live=polite aria-pressed=false><svg viewBox="0 0 24 24" width=24 height=24 class=lightToggleIcon_pyhR><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 class=darkToggleIcon_wfgR><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg></button></div><div class=navbarSearchContainer_Bca1><div class="navbar__search searchBarContainer_NW3z" dir=ltr><input placeholder=Search aria-label=Search class=navbar__search-input value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/metals/docs/>Text Editors</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/metals/docs/features/codeactions>Features</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/metals/docs/build-tools/overview>Build Tools</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/metals/docs/contributors/project-goals>Contributing</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/metals/docs/integrations/new-build-tool>Integrating with Metals</a></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/metals/docs/integrations/new-build-tool>Integrating a new build tool</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/metals/docs/integrations/new-editor>Integrating a new editor</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/metals/docs/integrations/test-explorer>Test Explorer</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/metals/docs/integrations/tree-view-protocol>Tree View Protocol</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/metals/docs/integrations/decoration-protocol>Decoration Protocol</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/metals/docs/integrations/debug-adapter-protocol>Running and debugging</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/metals/docs/troubleshooting/proxy>Troubleshooting</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/metals/docs/acknowledgements/development>Acknowledgements</a></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/metals/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Integrating with Metals</span><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>Running and debugging</span><meta itemprop=position content=2></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Running and debugging</h1></header><p>Metals implements the Debug Adapter Protocol, which can be used by the editor to
communicate with JVM to run and debug code. Alternatively, Metals is also able
to provide editors with all the information needed to run the code (this is
currently supported in run code lenses for main classes).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=how-to-add-support-for-debugging-or-running-in-my-editor>How to add support for debugging or running in my editor?<a href=#how-to-add-support-for-debugging-or-running-in-my-editor class=hash-link aria-label="Direct link to How to add support for debugging or running in my editor?" title="Direct link to How to add support for debugging or running in my editor?">​</a></h2>
<p>There are two main ways to add support for debugging depending on the
capabilities exposed by the client.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=via-code-lenses>Via code lenses<a href=#via-code-lenses class=hash-link aria-label="Direct link to Via code lenses" title="Direct link to Via code lenses">​</a></h3>
<p>If you want to use DAP the editor needs to handle two commands in its language
client extension:
<a href=https://github.com/scalameta/metals/blob/main/metals/src/main/scala/scala/meta/internal/metals/ClientCommands.scala target=_blank rel="noopener noreferrer"><code>metals-run-session-start</code></a>
and
<a href=https://github.com/scalameta/metals/blob/main/metals/src/main/scala/scala/meta/internal/metals/ClientCommands.scala target=_blank rel="noopener noreferrer"><code>metals-debug-session-start</code></a>.
These commands should get executed automatically by the LSP client once the user
activates a code lens. The difference between them is that the former ignores
all breakpoints being set while the latter respects them. The procedure of
starting the run/debug session is as follows:</p>
<p>Then we can request the debug adapter URI from the metals server using the
<a href=https://github.com/scalameta/metals/blob/master/metals/src/main/scala/scala/meta/internal/metals/ServerCommands.scala target=_blank rel="noopener noreferrer"><code>debug-adapter-start</code></a>
command.</p>
<p>Starting a Debug Adapter Protocol session might take some time, since it needs
to set up all the neccesary utilities for debugging. Metals also provides a
<code>shellCommand</code> field, which will be present in the command attached to the run
main methods code lenses. This field can be used to simply run the process
quickly without the debugging capabilities.</p>
<p>If you can't or won't support DAP, you can use the <code>runProvider</code> instead of
<code>debugProvider </code>option in the initialization options sent from the editor to the
Metals server. This will make sure that only the <code>run</code> code lense show up with
the needed <code>shellCommand</code> field.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=via-explicit-main-or-test-commands>Via explicit main or test commands<a href=#via-explicit-main-or-test-commands class=hash-link aria-label="Direct link to Via explicit main or test commands" title="Direct link to Via explicit main or test commands">​</a></h3>
<p>Apart from using code lenses, users can start a debug session by executing the
<code>debug-adapter-start</code> command with any of following params:</p>
<ul>
<li>for an explicit main class</li>
</ul>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-json codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain">{</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">  "mainClass": "com.foo.App",</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">  "buildTarget": "foo",</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">  "args": ["bar"],</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">  "jvmOptions": ["-Dpropert=123"],</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">  "env": { "RETRY": "TRUE" },</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">  "envFile": ".env"</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ul>
<li>for an explicit test class</li>
</ul>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-json codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain">{</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">  "testClass": "com.foo.FooSuite",</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">  "buildTarget": "foo"</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><code>buildTarget</code> is an optional parameter, which might be useful if there are
identically named classes in different modules. A URI will be returned that can
be used by the DAP client.</p>
<p><code>envFile</code> is an optional parameter, which allows you to specify a path to a
<code>.env</code> file with additional environment variables. The path can be either
absolute or relative to your project workspace. The parser supports single line
as well as multi-line quoted values (without value substitution). Any variables
defined in the <code>env</code> object take precedence over those from the <code>.env</code> file.
Here's an example of a supported <code>.env</code> file:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain"># single line values</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">key1=value 1</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">key2='value 2'   # ignored inline comment</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">key3="value 3"</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain"># multi-line values</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">key4='line 1</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">line 2'</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">key5="line 1</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">line 2"</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain"># export statements</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">export key6=value 6</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain"># comma delimiter</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">key7:value 6</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain"># keys cannot contain dots or dashes</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">a.b.key8=value 8   # will be ignored</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">a-b-key9=value 9   # will be ignored</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ul>
<li>for Metals discovery</li>
</ul>
<p>This option works a bit different than the other two param shapes as you don't
specify a test or main class, but rather a <code>runType</code> of either <code>"run"</code>,
<code>"runOrTestFile"</code>, <code>"testFile"</code>, or <code>"testTarget"</code> and a file URI representing
your current location. <code>"run"</code> will automatically find any main method in the
build target that belongs to the URI that was sent in. If multiple are found,
you will be given the choice of which to run. <code>"runOrTestFile"</code> will try to find
a main or test class in your current file and run them. The <code>"testFile"</code> option
will check for any test classes in your current file and run them. Similarly,
<code>"testTarget"</code> will run all test classes found in the build target that the URI
belongs to. The <code>"args"</code>, <code>"jvmOptions"</code>, <code>"env"</code>, and <code>"envFile"</code> are all valid
keys that can be sent as well with the same format as above.</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-json codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain">{</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">  "path": "file:///path/to/my/file.scala",</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">  "runType": "testTarget"</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Instead of <code>debug-adapter-start</code> if you only want to get data about the command
to run you can use <code>discover-jvm-run-command</code>, which takes the same json as
above, but instead of starting the DAP session it will return the
<code>DebugSessionParams</code> object containing targets that this main class can be run
for along with the data about the main class which will take form of:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-json codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain">{</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">  "targets": ["id1"],</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">  "dataKind": "scala-main-class",</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">  "data": {</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">    "class": "Foo",</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">    "arguments": [],</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">    "jvmOptions": [],</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">    "environmentVariables": [],</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">    "shellCommand": "java ..."</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">  }</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>where <code>shellCommand</code> will be the exact command to run if you want to run it on
your own without DAP.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=wiring-it-all-together>Wiring it all together<a href=#wiring-it-all-together class=hash-link aria-label="Direct link to Wiring it all together" title="Direct link to Wiring it all together">​</a></h3>
<p>No matter which method you use, you still need to connect the debug adapter
extension specific to you editor using the aforementioned URI and let it drive
the run/debug session. For reference, take a look at the
<a href=https://github.com/scalameta/metals-vscode/blob/main/packages/metals-vscode/src/debugger/scalaDebugger.ts target=_blank rel="noopener noreferrer">vscode implementation</a></p>
<p>and how it is
<a href=https://github.com/scalameta/metals-vscode/blob/main/packages/metals-vscode/src/extension.ts target=_blank rel="noopener noreferrer">wired up together</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=supported-testing-frameworks>Supported Testing Frameworks<a href=#supported-testing-frameworks class=hash-link aria-label="Direct link to Supported Testing Frameworks" title="Direct link to Supported Testing Frameworks">​</a></h2>
<p>NOTE: While Metals detects test suites for most of existing testing
frameworks, support for recognizing individual tests is more limited.
Metals supports the current set of test frameworks when it comes to
individual test discovery:</p>
<ul>
<li>Junit</li>
<li>MUnit</li>
<li>Scalatest</li>
<li>Weaver Test</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=debugging-the-connection>Debugging the connection<a href=#debugging-the-connection class=hash-link aria-label="Direct link to Debugging the connection" title="Direct link to Debugging the connection">​</a></h2>
<p>Create the following trace files to spy on incoming/outgoing JSON communication
between the debug server and editor.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_e6Vv><span class=token-line style=color:#bfc7d5><span class="token plain"># macOS</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">touch ~/Library/Caches/org.scalameta.metals/dap-server.trace.json</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">touch ~/Library/Caches/org.scalameta.metals/dap-client.trace.json</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Linux</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">touch ~/.cache/metals/dap-server.trace.json</span><br></span><span class=token-line style=color:#bfc7d5><span class="token plain">touch ~/.cache/metals/dap-client.trace.json</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/scalameta/metals/edit/main/docs/integrations/debug-adapter-protocol.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/metals/docs/integrations/decoration-protocol><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Decoration Protocol</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/metals/docs/troubleshooting/proxy><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Proxy and mirrors</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#how-to-add-support-for-debugging-or-running-in-my-editor class="table-of-contents__link toc-highlight">How to add support for debugging or running in my editor?</a><ul><li><a href=#via-code-lenses class="table-of-contents__link toc-highlight">Via code lenses</a><li><a href=#via-explicit-main-or-test-commands class="table-of-contents__link toc-highlight">Via explicit main or test commands</a><li><a href=#wiring-it-all-together class="table-of-contents__link toc-highlight">Wiring it all together</a></ul><li><a href=#supported-testing-frameworks class="table-of-contents__link toc-highlight">Supported Testing Frameworks</a><li><a href=#debugging-the-connection class="table-of-contents__link toc-highlight">Debugging the connection</a></ul></div></div></div></div></main></div></div></div><footer class=footer><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class=footer__title>Overview</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/metals/docs/>Overview</a><li class=footer__item><a class=footer__link-item href=/metals/docs/build-tools/overview>Build Tools</a><li class=footer__item><a class=footer__link-item href=/metals/docs/contributors/project-goals>Project Goals</a><li class=footer__item><a class=footer__link-item href=/metals/docs/contributors/getting-started>Contributing</a></ul></div><div class="col footer__col"><div class=footer__title>Social</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/scalameta/metals target=_blank>
                      <img src="https://img.shields.io/github/stars/scalameta/metals.svg?color=%23087e8b&label=stars&logo=github&style=social">
                    </a><li class=footer__item><a href=https://discord.gg/RFpSVth target=_blank>
                      <img src="https://img.shields.io/discord/632642981228314653?logo=discord&style=social">
                    </a><li class=footer__item><a href=https://twitter.com/scalameta target=_blank>
                      <img src="https://img.shields.io/twitter/follow/scalameta.svg?logo=twitter&style=social">
                    </a></ul></div></div><div class="footer__bottom text--center"><div class=margin-bottom--sm><img src=/metals/img/scalameta-logo.png class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src=/metals/img/scalameta-logo.png class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></div><div class=footer__copyright>Copyright © 2024 Metals</div></div></div></footer></div>