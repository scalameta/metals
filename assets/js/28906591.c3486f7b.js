"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1648],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>u});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,d=r(e,["components","mdxType","originalType","parentName"]),m=p(n),u=i,h=m["".concat(s,".").concat(u)]||m[u]||c[u]||o;return n?a.createElement(h,l(l({ref:t},d),{},{components:n})):a.createElement(h,l({ref:t},d))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,l=new Array(o);l[0]=m;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r.mdxType="string"==typeof e?e:i,l[1]=r;for(var p=2;p<o;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},5691:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>s,default:()=>m,frontMatter:()=>r,metadata:()=>p,toc:()=>d});var a=n(7462),i=n(3366),o=(n(7294),n(3905)),l=["components"],r={id:"new-editor",title:"Integrating a new editor"},s=void 0,p={unversionedId:"integrations/new-editor",id:"integrations/new-editor",title:"Integrating a new editor",description:"Metals is a language server implemented in Scala that communicates with a single",source:"@site/target/docs/integrations/new-editor.md",sourceDirName:"integrations",slug:"/integrations/new-editor",permalink:"/metals/docs/integrations/new-editor",editUrl:"https://github.com/scalameta/metals/edit/main/docs/integrations/new-editor.md",tags:[],version:"current",frontMatter:{id:"new-editor",title:"Integrating a new editor"},sidebar:"docs",previous:{title:"Integrating a new build tool",permalink:"/metals/docs/integrations/new-build-tool"},next:{title:"Test Explorer",permalink:"/metals/docs/integrations/test-explorer"}},d=[{value:"Requirements",id:"requirements",children:[],level:2},{value:"Starting the server",id:"starting-the-server",children:[],level:2},{value:"Configuring the server",id:"configuring-the-server",children:[],level:2},{value:"Language Server Protocol",id:"language-server-protocol",children:[{value:"<code>initialize</code>",id:"initialize",children:[{value:"<code>InitializationOptions</code>",id:"initializationoptions",children:[{value:"<code>compilerOptions.completionCommand</code>",id:"compileroptionscompletioncommand",children:[],level:5},{value:"<code>compilerOptions.isCompletionItemDetailEnabled</code>",id:"compileroptionsiscompletionitemdetailenabled",children:[],level:5},{value:"<code>compilerOptions.isCompletionItemDocumentationEnabled</code>",id:"compileroptionsiscompletionitemdocumentationenabled",children:[],level:5},{value:"<code>compilerOptions.isCompletionItemResolve</code>",id:"compileroptionsiscompletionitemresolve",children:[],level:5},{value:"<code>compilerOptions.isHoverDocumentationEnabled</code>",id:"compileroptionsishoverdocumentationenabled",children:[],level:5},{value:"<code>compilerOptions.isSignatureHelpDocumentationEnabled</code>",id:"compileroptionsissignaturehelpdocumentationenabled",children:[],level:5},{value:"<code>compilerOptions.overrideDefFormat</code>",id:"compileroptionsoverridedefformat",children:[],level:5},{value:"<code>compilerOptions.parameterHintsCommand</code>",id:"compileroptionsparameterhintscommand",children:[],level:5},{value:"<code>compilerOptions.snippetAutoIndent</code>",id:"compileroptionssnippetautoindent",children:[],level:5},{value:"<code>copyWorksheetOutputProvider</code>",id:"copyworksheetoutputprovider",children:[],level:5},{value:"<code>debuggingProvider</code>",id:"debuggingprovider",children:[],level:5},{value:"<code>decorationProvider</code>",id:"decorationprovider",children:[],level:5},{value:"<code>didFocusProvider</code>",id:"didfocusprovider",children:[],level:5},{value:"<code>disableColorOutput</code>",id:"disablecoloroutput",children:[],level:5},{value:"<code>doctorProvider</code>",id:"doctorprovider",children:[],level:5},{value:"<code>executeClientCommandProvider</code>",id:"executeclientcommandprovider",children:[],level:5},{value:"<code>globSyntax</code>",id:"globsyntax",children:[],level:5},{value:"<code>inlineDecorationProvider</code>",id:"inlinedecorationprovider",children:[],level:5},{value:"<code>icons</code>",id:"icons",children:[],level:5},{value:"<code>inputBoxProvider</code>",id:"inputboxprovider",children:[],level:5},{value:"<code>isExitOnShutdown</code>",id:"isexitonshutdown",children:[],level:5},{value:"<code>isHttpEnabled</code>",id:"ishttpenabled",children:[],level:5},{value:"<code>openFilesOnRenameProvider</code>",id:"openfilesonrenameprovider",children:[],level:5},{value:"<code>openNewWindowProvider</code>",id:"opennewwindowprovider",children:[],level:5},{value:"<code>quickPickProvider</code>",id:"quickpickprovider",children:[],level:5},{value:"<code>renameFileThreshold</code>",id:"renamefilethreshold",children:[],level:5},{value:"<code>slowTaskProvider</code>",id:"slowtaskprovider",children:[],level:5},{value:"<code>statusBarProvider</code>",id:"statusbarprovider",children:[],level:5},{value:"<code>treeViewProvider</code>",id:"treeviewprovider",children:[],level:5}],level:4},{value:"Experimental Capabilities",id:"experimental-capabilities",children:[],level:4}],level:3},{value:"<code>initialized</code>",id:"initialized",children:[],level:3},{value:"<code>shutdown</code>",id:"shutdown",children:[],level:3},{value:"<code>exit</code>",id:"exit",children:[],level:3},{value:"<code>$/cancelRequest</code>",id:"cancelrequest",children:[],level:3},{value:"<code>client/registerCapability</code>",id:"clientregistercapability",children:[],level:3},{value:"<code>textDocument/didOpen</code>",id:"textdocumentdidopen",children:[],level:3},{value:"<code>textDocument/didChange</code>",id:"textdocumentdidchange",children:[],level:3},{value:"<code>textDocument/didClose</code>",id:"textdocumentdidclose",children:[],level:3},{value:"<code>textDocument/didSave</code>",id:"textdocumentdidsave",children:[],level:3},{value:"<code>textDocument/publishDiagnostics</code>",id:"textdocumentpublishdiagnostics",children:[],level:3},{value:"<code>textDocument/definition</code>",id:"textdocumentdefinition",children:[],level:3},{value:"<code>textDocument/references</code>",id:"textdocumentreferences",children:[],level:3},{value:"<code>textDocument/documentSymbol</code>",id:"textdocumentdocumentsymbol",children:[],level:3},{value:"<code>textDocument/formatting</code>",id:"textdocumentformatting",children:[],level:3},{value:"<code>textDocument/hover</code>",id:"textdocumenthover",children:[],level:3},{value:"<code>workspace/didChangeWatchedFiles</code>",id:"workspacedidchangewatchedfiles",children:[],level:3},{value:"<code>workspace/executeCommands</code>",id:"workspaceexecutecommands",children:[],level:3},{value:"<code>workspace/didChangeConfiguration</code>",id:"workspacedidchangeconfiguration",children:[],level:3},{value:"<code>window/logMessage</code>",id:"windowlogmessage",children:[],level:3},{value:"<code>window/showMessage</code>",id:"windowshowmessage",children:[],level:3},{value:"<code>window/showMessageRequest</code>",id:"windowshowmessagerequest",children:[],level:3}],level:2},{value:"Metals server properties",id:"metals-server-properties",children:[{value:"<code>-Dmetals.verbose</code>",id:"-dmetalsverbose",children:[],level:3},{value:"<code>-Dmetals.statistics</code>",id:"-dmetalsstatistics",children:[],level:3},{value:"<code>-Dmetals.h2.auto-server</code>",id:"-dmetalsh2auto-server",children:[],level:3},{value:"<code>-Dmetals.pc.debug</code>",id:"-dmetalspcdebug",children:[],level:3},{value:"<code>-Dbloop.sbt.version</code>",id:"-dbloopsbtversion",children:[],level:3},{value:"<code>-Dmetals.bloop-port</code>",id:"-dmetalsbloop-port",children:[],level:3}],level:2},{value:"Metals user configuration",id:"metals-user-configuration",children:[{value:"Java Home directory",id:"java-home-directory",children:[],level:3},{value:"sbt script",id:"sbt-script",children:[],level:3},{value:"Gradle script",id:"gradle-script",children:[],level:3},{value:"Maven script",id:"maven-script",children:[],level:3},{value:"Mill script",id:"mill-script",children:[],level:3},{value:"Scalafmt config path",id:"scalafmt-config-path",children:[],level:3},{value:"Scalafix config path",id:"scalafix-config-path",children:[],level:3},{value:"Ammonite JVM Properties",id:"ammonite-jvm-properties",children:[],level:3},{value:"Excluded Packages",id:"excluded-packages",children:[],level:3},{value:"Don&#39;t generate Bloop plugin file for sbt",id:"dont-generate-bloop-plugin-file-for-sbt",children:[],level:3},{value:"Version of Bloop",id:"version-of-bloop",children:[],level:3},{value:"Should display lenses with links to super methods",id:"should-display-lenses-with-links-to-super-methods",children:[],level:3},{value:"Should display type annotations for inferred types",id:"should-display-type-annotations-for-inferred-types",children:[],level:3},{value:"Should display implicit parameter at usage sites",id:"should-display-implicit-parameter-at-usage-sites",children:[],level:3},{value:"Should display implicit conversion at usage sites",id:"should-display-implicit-conversion-at-usage-sites",children:[],level:3},{value:"Should try adjust indentation on range formatting.",id:"should-try-adjust-indentation-on-range-formatting",children:[],level:3},{value:"Remote language server",id:"remote-language-server",children:[],level:3},{value:"Default fallback Scala version",id:"default-fallback-scala-version",children:[],level:3},{value:"Test UI used for tests and test suites",id:"test-ui-used-for-tests-and-test-suites",children:[],level:3},{value:"Eclipse Java formatter config path",id:"eclipse-java-formatter-config-path",children:[],level:3},{value:"Eclipse Java formatting profile",id:"eclipse-java-formatting-profile",children:[],level:3}],level:2},{value:"Metals server commands",id:"metals-server-commands",children:[{value:"Analyze stacktrace",id:"analyze-stacktrace",children:[],level:3},{value:"Switch build server",id:"switch-build-server",children:[],level:3},{value:"Connect to build server",id:"connect-to-build-server",children:[],level:3},{value:"Cancel compilation",id:"cancel-compilation",children:[],level:3},{value:"Cascade compile",id:"cascade-compile",children:[],level:3},{value:"Clean compile workspace",id:"clean-compile-workspace",children:[],level:3},{value:"Copy Worksheet Output",id:"copy-worksheet-output",children:[],level:3},{value:"Discover tests",id:"discover-tests",children:[],level:3},{value:"Disconnect to build server",id:"disconnect-to-build-server",children:[],level:3},{value:"List build targets",id:"list-build-targets",children:[],level:3},{value:"Scan sources",id:"scan-sources",children:[],level:3},{value:"Start Ammonite build server",id:"start-ammonite-build-server",children:[],level:3},{value:"Start debug adapter",id:"start-debug-adapter",children:[],level:3},{value:"Stop Ammonite build server",id:"stop-ammonite-build-server",children:[],level:3},{value:"Go to super method/field definition in hierarchy",id:"go-to-super-methodfield-definition-in-hierarchy",children:[],level:3}],level:2},{value:"Metals client commands",id:"metals-client-commands",children:[{value:"Open a specified folder either in the same or new window",id:"open-a-specified-folder-either-in-the-same-or-new-window",children:[],level:3},{value:"Run doctor",id:"run-doctor",children:[],level:3},{value:"Reload doctor",id:"reload-doctor",children:[],level:3},{value:"Toggle logs",id:"toggle-logs",children:[],level:3},{value:"Open problems",id:"open-problems",children:[],level:3},{value:"Goto location",id:"goto-location",children:[],level:3},{value:"Echo command",id:"echo-command",children:[],level:3},{value:"Refresh model",id:"refresh-model",children:[],level:3},{value:"Show the stacktrace in the client.",id:"show-the-stacktrace-in-the-client",children:[],level:3},{value:"Copy Worksheet Output",id:"copy-worksheet-output-1",children:[],level:3},{value:"Start run session",id:"start-run-session",children:[],level:3},{value:"Start debug session",id:"start-debug-session",children:[],level:3}],level:2},{value:"Metals HTTP client",id:"metals-http-client",children:[],level:2},{value:"Metals LSP extensions",id:"metals-lsp-extensions",children:[{value:"Debug Adapter Protocol",id:"debug-adapter-protocol",children:[],level:3},{value:"Tree View Protocol",id:"tree-view-protocol",children:[],level:3},{value:"Decoration Protocol",id:"decoration-protocol",children:[],level:3},{value:"<code>metals/slowTask</code>",id:"metalsslowtask",children:[],level:3},{value:"<code>metals/status</code>",id:"metalsstatus",children:[],level:3},{value:"<code>metals/didFocusTextDocument</code>",id:"metalsdidfocustextdocument",children:[],level:3},{value:"<code>metals/executeClientCommand</code>",id:"metalsexecuteclientcommand",children:[],level:3},{value:"<code>metals/inputBox</code>",id:"metalsinputbox",children:[],level:3},{value:"<code>metals/quickPick</code>",id:"metalsquickpick",children:[],level:3},{value:"<code>metals/windowStateDidChange</code>",id:"metalswindowstatedidchange",children:[],level:3},{value:"<code>metals/openWindow</code>",id:"metalsopenwindow",children:[],level:3},{value:"<code>metals/findTextInDependencyJars</code>",id:"metalsfindtextindependencyjars",children:[],level:3}],level:2}],c={toc:d};function m(e){var t=e.components,n=(0,i.Z)(e,l);return(0,o.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Metals is a language server implemented in Scala that communicates with a single\nclient over ",(0,o.kt)("a",{parentName:"p",href:"https://www.jsonrpc.org/specification"},"JSON-RPC"),"."),(0,o.kt)("h2",{id:"requirements"},"Requirements"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Java 8, 11, 17 provided by OpenJDK or Oracle"),". Eclipse OpenJ9 is not\nsupported, please make sure the ",(0,o.kt)("inlineCode",{parentName:"p"},"JAVA_HOME")," environment variable\npoints to a valid Java 8, 11 or 17 installation."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"macOS, Linux or Windows"),". Metals is developed on many operating systems and\nevery PR is tested on Ubuntu, Windows and MacOS."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Scala 2.13, 2.12, 2.11 and Scala 3"),". Metals supports these Scala versions:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Scala 2.13"),":\n2.13.8, 2.13.7, 2.13.6, 2.13.5, 2.13.4, 2.13.3, 2.13.2, 2.13.1")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Scala 2.12"),":\n2.12.15, 2.12.14, 2.12.13, 2.12.12, 2.12.11, 2.12.10, 2.12.9, 2.12.8")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Scala 2.11"),":\n2.11.12")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Scala 3"),":\n3.1.2-RC3, 3.1.2-RC2, 3.1.1, 3.1.0, 3.0.2, 3.0.1, 3.0.0"))),(0,o.kt)("p",null,"Note that 2.11.x support is deprecated and it will be removed in future releases.\nIt's recommended to upgrade to Scala 2.12 or Scala 2.13"),(0,o.kt)("h2",{id:"starting-the-server"},"Starting the server"),(0,o.kt)("p",null,"Use ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/coursier/coursier"},"Coursier")," to obtain the JVM classpath\nof Metals:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"coursier bootstrap org.scalameta:metals_2.12:0.11.2+117-73d6fc1f-SNAPSHOT -o metals -f\n")),(0,o.kt)("p",null,"(optional) It's recommended to enable JVM string de-duplication and provide a\ngenerous stack size and memory options."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"coursier bootstrap \\\n  --java-opt -XX:+UseG1GC \\\n  --java-opt -XX:+UseStringDeduplication  \\\n  --java-opt -Xss4m \\\n  --java-opt -Xms100m \\\n  org.scalameta:metals_2.12:0.11.2+117-73d6fc1f-SNAPSHOT -o metals -f\n")),(0,o.kt)("p",null,"See ",(0,o.kt)("a",{parentName:"p",href:"#metals-server-properties"},"Metals server properties")," for additional system\nproperties that are supported by the server."),(0,o.kt)("p",null,"JSON-RPC communication takes place over standard input/output so the Metals\nserver doesn't print anything to the console when it starts. Instead, before\nestablishing a connection with the client, Metals logs notifications to a global\ndirectory:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"# macOS\n~/Library/Caches/org.scalameta.metals/global.log\n# Linux\n$XDG_CACHE_HOME/org.scalameta.metals/global.log\n# Linux (alternative)\n$HOME/.cache/org.scalameta.metals/global.log\n# Windows\n{FOLDERID_LocalApplicationData}\\.cache\\org.scalameta.metals\\global.log\n")),(0,o.kt)("p",null,"After establishing a connection with the client, Metals redirects logs to the\n",(0,o.kt)("inlineCode",{parentName:"p"},".metals/metals.log")," file in the LSP workspace root directory."),(0,o.kt)("p",null,"Metals supports two kinds of JSON-RPC endpoints:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#language-server-protocol"},"Language Server Protocol"),": for the main\nfunctionality of the server, including editor text synchronization and\nsemantic features such as goto definition."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#metals-lsp-extensions"},"Metals extensions"),": for additional functionality that\nis missing in LSP but improves the user experience.")),(0,o.kt)("h2",{id:"configuring-the-server"},"Configuring the server"),(0,o.kt)("p",null,"Over time the recommended way to configure Metals has shifted from heavily\nrelying on the ",(0,o.kt)("a",{parentName:"p",href:"#metals-server-properties"},"Metals server properties")," to being\nfully able to be configured via ",(0,o.kt)("inlineCode",{parentName:"p"},"InitializationOptions")," which are exchanged\nduring the\n",(0,o.kt)("a",{parentName:"p",href:"https://microsoft.github.io/language-server-protocol/specification#initialize"},(0,o.kt)("inlineCode",{parentName:"a"},"initialize")),"\nprocess. While Metals will still work being fully configured by server\nproperties, we strongly recommend that instead you rely on the\n",(0,o.kt)("inlineCode",{parentName:"p"},"InitializationOptions")," which are thoroughly covered below in the\n","[",(0,o.kt)("inlineCode",{parentName:"p"},"initialize"),"]","(#initialize] section."),(0,o.kt)("h2",{id:"language-server-protocol"},"Language Server Protocol"),(0,o.kt)("p",null,"Consult the\n",(0,o.kt)("a",{parentName:"p",href:"https://microsoft.github.io/language-server-protocol/specification"},"LSP specification"),"\nto learn more more how LSP works. Metals uses the following endpoints from the\nspecification."),(0,o.kt)("h3",{id:"initialize"},(0,o.kt)("inlineCode",{parentName:"h3"},"initialize")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"the ",(0,o.kt)("inlineCode",{parentName:"li"},"rootUri")," field is used to configure Metals for that workspace directory.\nThe working directory for where server is started has no significant meaning."),(0,o.kt)("li",{parentName:"ul"},"at this point, Metals uses only full text synchronization. In the future, it\nwill be able to use incremental text synchronization."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"didChangeWatchedFiles")," client capability is used to determine whether to\nregister file watchers.")),(0,o.kt)("h4",{id:"initializationoptions"},(0,o.kt)("inlineCode",{parentName:"h4"},"InitializationOptions")),(0,o.kt)("p",null,"During ",(0,o.kt)("inlineCode",{parentName:"p"},"initialize")," we also have the ability to pass in ",(0,o.kt)("inlineCode",{parentName:"p"},"InitializationOptions"),'.\nThis is the primary way to configure Metals. In Metals we have a few different\n"providers". Some are LSP extensions, such as ',(0,o.kt)("inlineCode",{parentName:"p"},"metals/inputBox")," which you read\nabout below, and others used to be server properties that have been migrated to\n",(0,o.kt)("inlineCode",{parentName:"p"},"InitializationOptions"),". M"),(0,o.kt)("p",null,"The currently available settings for ",(0,o.kt)("inlineCode",{parentName:"p"},"InitializationOptions")," are listed below."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'    "InitializationOptions": {\n      "compilerOptions":{\n        "completionCommand": string,\n        "isCompletionItemDetailEnabled": boolean,\n        "isCompletionItemDocumentationEnabled": boolean,\n        "isCompletionItemResolve": boolean,\n        "isHoverDocumentationEnabled": boolean,\n        "isSignatureHelpDocumentationEnabled": boolean,\n        "overrideDefFormat": "ascii" | "unicode",\n        "parameterHintsCommand": string,\n        "snippetAutoIndent": boolean,\n      }\n      "copyWorksheetOutputProvider": boolean,\n      "debuggingProvider": boolean,\n      "decorationProvider": boolean,\n      "didFocusProvider": boolean,\n      "disableColorOutput" boolean,\n      "doctorProvider": "json" | "html",\n      "executeClientCommandProvider": boolean,\n      "globSyntax": "vscode" | "uri"\n      "icons": "octicons" | "vscode" | "unicode",\n      "inlineDecorationProvider": boolean,\n      "inputBoxProvider": boolean,\n      "isExitOnShutdown" : boolean,\n      "isHttpEnabled": boolean,\n      "commandInHtmlFormat": "vscode" | "sublime",\n      "openFilesOnRenameProvider": boolean,\n      "openNewWindowProvider": boolean,\n      "quickPickProvider": boolean,\n      "renameFileThreshold": number,\n      "slowTaskProvider": boolean,\n      "statusBarProvider": "on" | "off" | "show-message" | "log-message",\n      "treeViewProvider": boolean\n    }\n')),(0,o.kt)("p",null,"You can also always check these in the\n",(0,o.kt)("a",{parentName:"p",href:"https://github.com/scalameta/metals/blob/main/metals/src/main/scala/scala/meta/internal/metals/InitializationOptions.scala"},(0,o.kt)("inlineCode",{parentName:"a"},"InitializationOptions.scala")),"\nfile where you'll find all of the options and descriptions."),(0,o.kt)("h5",{id:"compileroptionscompletioncommand"},(0,o.kt)("inlineCode",{parentName:"h5"},"compilerOptions.completionCommand")),(0,o.kt)("p",null,"An optional string value for a command identifier to trigger completion\n(",(0,o.kt)("inlineCode",{parentName:"p"},"textDocument/signatureHelp"),") in the editor."),(0,o.kt)("p",null,"Possible values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},'"editor.action.triggerSuggest"'),": currently used by Visual Studio Code and\ncoc.nvim."),(0,o.kt)("li",{parentName:"ul"},"empty: for all other editors.")),(0,o.kt)("h5",{id:"compileroptionsiscompletionitemdetailenabled"},(0,o.kt)("inlineCode",{parentName:"h5"},"compilerOptions.isCompletionItemDetailEnabled")),(0,o.kt)("p",null,"Boolean value signifying whether or not the ",(0,o.kt)("inlineCode",{parentName:"p"},"CompletionItem.detail")," field should\nbe populated."),(0,o.kt)("p",null,"Default value: ",(0,o.kt)("inlineCode",{parentName:"p"},"true")),(0,o.kt)("h5",{id:"compileroptionsiscompletionitemdocumentationenabled"},(0,o.kt)("inlineCode",{parentName:"h5"},"compilerOptions.isCompletionItemDocumentationEnabled")),(0,o.kt)("p",null,"Boolean value signifying whether or not the ",(0,o.kt)("inlineCode",{parentName:"p"},"CompletionItem.documentation")," field\nshould be populated."),(0,o.kt)("p",null,"Default value: ",(0,o.kt)("inlineCode",{parentName:"p"},"true")),(0,o.kt)("h5",{id:"compileroptionsiscompletionitemresolve"},(0,o.kt)("inlineCode",{parentName:"h5"},"compilerOptions.isCompletionItemResolve")),(0,o.kt)("p",null,"Boolean value signifying whether the client wants Metals to handle the\n",(0,o.kt)("inlineCode",{parentName:"p"},"completionItem/resolve")," request."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://microsoft.github.io/language-server-protocol/specification#completionItem_resolve"},"https://microsoft.github.io/language-server-protocol/specification#completionItem_resolve")),(0,o.kt)("p",null,"Default value: ",(0,o.kt)("inlineCode",{parentName:"p"},"true")),(0,o.kt)("h5",{id:"compileroptionsishoverdocumentationenabled"},(0,o.kt)("inlineCode",{parentName:"h5"},"compilerOptions.isHoverDocumentationEnabled")),(0,o.kt)("p",null,"Boolean value signifying whether to include docstrings in a ",(0,o.kt)("inlineCode",{parentName:"p"},"textDocument/hover"),"\nrequest."),(0,o.kt)("p",null,"Default value: ",(0,o.kt)("inlineCode",{parentName:"p"},"true")),(0,o.kt)("h5",{id:"compileroptionsissignaturehelpdocumentationenabled"},(0,o.kt)("inlineCode",{parentName:"h5"},"compilerOptions.isSignatureHelpDocumentationEnabled")),(0,o.kt)("p",null,"Boolean value signifying whether or not the ",(0,o.kt)("inlineCode",{parentName:"p"},"SignatureHelp.documentation")," field\nshould be populated."),(0,o.kt)("p",null,"Default value: ",(0,o.kt)("inlineCode",{parentName:"p"},"true")),(0,o.kt)("h5",{id:"compileroptionsoverridedefformat"},(0,o.kt)("inlineCode",{parentName:"h5"},"compilerOptions.overrideDefFormat")),(0,o.kt)("p",null,"Whether or not the presentation compiler overrides should show unicode icon or\njust be in ascii format."),(0,o.kt)("p",null,"Possible Values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},'"ascii"')," (default)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unicode"),' show the "\ud83d\udd3c" icon in overrides.')),(0,o.kt)("h5",{id:"compileroptionsparameterhintscommand"},(0,o.kt)("inlineCode",{parentName:"h5"},"compilerOptions.parameterHintsCommand")),(0,o.kt)("p",null,"An optional string value for a command identifier to trigger parameter hints\n(",(0,o.kt)("inlineCode",{parentName:"p"},"textDocument/signatureHelp"),") in the editor. Metals uses this setting to\npopulate ",(0,o.kt)("inlineCode",{parentName:"p"},"CompletionItem.command")," for completion items that move the cursor\ninside an argument list. For example, when completing ",(0,o.kt)("inlineCode",{parentName:"p"},'"".stripSu@@')," into\n",(0,o.kt)("inlineCode",{parentName:"p"},'"".stripSuffix(@@)'),", Metals will automatically trigger parameter hints if this\nsetting is provided by the editor."),(0,o.kt)("p",null,"Possible values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},'"editor.action.triggerParameterHints"'),": Used by Visual Studio Code and\ncoc.nvim."),(0,o.kt)("li",{parentName:"ul"},"empty: for all other editors.")),(0,o.kt)("h5",{id:"compileroptionssnippetautoindent"},(0,o.kt)("inlineCode",{parentName:"h5"},"compilerOptions.snippetAutoIndent")),(0,o.kt)("p",null,'Certain editors will automatically insert indentation equal to that of the\nreference line that the operation started on. This is relevant in the case of\nmultiline textEdits such as the "implement all methods" completion.'),(0,o.kt)("p",null,"Possible values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"on"),": (default): the client automatically adds in the indentation. This is the\ncase for VS Code, Sublime, and coc.nvim."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"off"),": the client does not add any indentation when receiving a multi-line\ntextEdit")),(0,o.kt)("h5",{id:"copyworksheetoutputprovider"},(0,o.kt)("inlineCode",{parentName:"h5"},"copyWorksheetOutputProvider")),(0,o.kt)("p",null,"Boolean value signifying whether or not the client supports running\nCopyWorksheetOutput server command and copying it's results into the local\nbuffer."),(0,o.kt)("p",null,"Default value: ",(0,o.kt)("inlineCode",{parentName:"p"},"false")),(0,o.kt)("h5",{id:"debuggingprovider"},(0,o.kt)("inlineCode",{parentName:"h5"},"debuggingProvider")),(0,o.kt)("p",null,"Boolean value to signify that the client supports the\n",(0,o.kt)("a",{parentName:"p",href:"/metals/docs/integrations/debug-adapter-protocol"},"Debug Adapter Protocol"),"."),(0,o.kt)("p",null,"Default value: ",(0,o.kt)("inlineCode",{parentName:"p"},"false")),(0,o.kt)("h5",{id:"decorationprovider"},(0,o.kt)("inlineCode",{parentName:"h5"},"decorationProvider")),(0,o.kt)("p",null,"Boolean value to signify that the client supports the\n",(0,o.kt)("a",{parentName:"p",href:"/metals/docs/integrations/decoration-protocol"},"Decoration Protocol"),"."),(0,o.kt)("p",null,"Default value: ",(0,o.kt)("inlineCode",{parentName:"p"},"false")),(0,o.kt)("h5",{id:"didfocusprovider"},(0,o.kt)("inlineCode",{parentName:"h5"},"didFocusProvider")),(0,o.kt)("p",null,"Boolean value to signify that the client supports the\n",(0,o.kt)("a",{parentName:"p",href:"#metalsdidfocustextdocument"},(0,o.kt)("inlineCode",{parentName:"a"},"metals/didFocusTextDocument"))," extension."),(0,o.kt)("p",null,"Default value: ",(0,o.kt)("inlineCode",{parentName:"p"},"false")),(0,o.kt)("h5",{id:"disablecoloroutput"},(0,o.kt)("inlineCode",{parentName:"h5"},"disableColorOutput")),(0,o.kt)("p",null,"Useful for certain DAP clients that are unable to handle color codes for output.\nThis will remove the color codes coming from whatever DAP server is currently\nbeing used."),(0,o.kt)("p",null,"Default value: ",(0,o.kt)("inlineCode",{parentName:"p"},"false")),(0,o.kt)("h5",{id:"doctorprovider"},(0,o.kt)("inlineCode",{parentName:"h5"},"doctorProvider")),(0,o.kt)("p",null,"Format that you'd like Doctor to return information in."),(0,o.kt)("p",null,"Possible values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"html"),": (default): Metals will return html that can be rendered directly in\nthe browser or web view"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"json"),": json representation of the information returned by Doctor")),(0,o.kt)("h5",{id:"executeclientcommandprovider"},(0,o.kt)("inlineCode",{parentName:"h5"},"executeClientCommandProvider")),(0,o.kt)("p",null,"Possible values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"off")," (default): the ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/executeClientCommand")," notification is not\nsupported. Client commands can still be handled by enabling\n",(0,o.kt)("inlineCode",{parentName:"li"},"-Dmetals.http=on"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"on"),": the ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/executeClientCommand")," notification is supported and all\n",(0,o.kt)("a",{parentName:"li",href:"#metals-client-commands"},"Metals client commands")," are handled.")),(0,o.kt)("h5",{id:"globsyntax"},(0,o.kt)("inlineCode",{parentName:"h5"},"globSyntax")),(0,o.kt)("p",null,"Controls the glob syntax for registering file watchers on absolute directories.\nRegistration happens via ",(0,o.kt)("inlineCode",{parentName:"p"},"client/registerCapability")," for the\n",(0,o.kt)("a",{parentName:"p",href:"#workspacedidchangewatchedfiles"},(0,o.kt)("inlineCode",{parentName:"a"},"workspace/didChangeWatchedFiles"))," method, if\nthe editor client supports it."),(0,o.kt)("p",null,"Possible values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"uri")," (default): URI-encoded file paths, with forward slash ",(0,o.kt)("inlineCode",{parentName:"li"},"/")," for file\nseparators regardless of the operating system. Includes ",(0,o.kt)("inlineCode",{parentName:"li"},"file://")," prefix."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"vscode"),": use regular Path.toString for the absolute directory parts (",(0,o.kt)("inlineCode",{parentName:"li"},"/")," on\nmacOS+Linux and ",(0,o.kt)("inlineCode",{parentName:"li"},"\\")," on Windows) and forward slashes ",(0,o.kt)("inlineCode",{parentName:"li"},"/")," for relative parts.\nFor example, ",(0,o.kt)("inlineCode",{parentName:"li"},"C:\\Users\\IEUser\\workspace\\project/*.{scala,sbt,properties}"),".\nThis mode is used by the VS Code client.")),(0,o.kt)("h5",{id:"inlinedecorationprovider"},(0,o.kt)("inlineCode",{parentName:"h5"},"inlineDecorationProvider")),(0,o.kt)("p",null,"If the client implements the Metals Decoration Protocol ",(0,o.kt)("strong",{parentName:"p"},"and")," supports\ndecorations to be shown inline and not only at the end of a line."),(0,o.kt)("p",null,"Default: ",(0,o.kt)("inlineCode",{parentName:"p"},"false")),(0,o.kt)("h5",{id:"icons"},(0,o.kt)("inlineCode",{parentName:"h5"},"icons")),(0,o.kt)("p",null,"Possible values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"none")," (default): don't display icons in messages."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"vscode"),": use ",(0,o.kt)("a",{parentName:"li",href:"https://octicons.github.com"},"Octicons")," such as ",(0,o.kt)("inlineCode",{parentName:"li"},"$(rocket)")," for\nstatus bar messages, as supported by th\n",(0,o.kt)("a",{parentName:"li",href:"https://code.visualstudio.com/docs/extensionAPI/vscode-api#StatusBarItem"},"VS Code status bar"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unicode"),": use unicode emojis like \ud83d\ude80 for status bar messages.")),(0,o.kt)("h5",{id:"inputboxprovider"},(0,o.kt)("inlineCode",{parentName:"h5"},"inputBoxProvider")),(0,o.kt)("p",null,"Possible values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"off")," (default): the ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/inputBox")," request is not supported. In this case,\nMetals tries to fallback to ",(0,o.kt)("inlineCode",{parentName:"li"},"window/showMessageRequest")," when possible."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"on"),": the ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/inputBox")," request is fully supported.")),(0,o.kt)("h5",{id:"isexitonshutdown"},(0,o.kt)("inlineCode",{parentName:"h5"},"isExitOnShutdown")),(0,o.kt)("p",null,"Possible values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"off")," (default): run ",(0,o.kt)("inlineCode",{parentName:"li"},"System.exit")," only on the ",(0,o.kt)("inlineCode",{parentName:"li"},"exit")," notification, as\nrequired by the LSP specification."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"on"),": run ",(0,o.kt)("inlineCode",{parentName:"li"},"System.exit")," after the ",(0,o.kt)("inlineCode",{parentName:"li"},"shutdown")," request, going against the LSP\nspecification. This option is enabled by default for Sublime Text to prevent\nthe Metals process from staying alive after Sublime Text has quit with\n",(0,o.kt)("inlineCode",{parentName:"li"},"Cmd+Q"),". It's not possible for Sublime Text packages to register a callback\nwhen the editor has quit. See\n",(0,o.kt)("a",{parentName:"li",href:"https://github.com/tomv564/LSP/issues/410"},"LSP#410")," for more details.")),(0,o.kt)("h5",{id:"ishttpenabled"},(0,o.kt)("inlineCode",{parentName:"h5"},"isHttpEnabled")),(0,o.kt)("p",null,"Possible values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"off")," (default): don't start a server with the Metals HTTP client."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"on"),": start a server with the ","[Metals HTTP client]"," to interact with the server\nthrough a basic web UI. This option is needed for editor clients that don't\nsupport necessary requests such as ",(0,o.kt)("inlineCode",{parentName:"li"},"window/showMessageRequest"),".")),(0,o.kt)("h5",{id:"openfilesonrenameprovider"},(0,o.kt)("inlineCode",{parentName:"h5"},"openFilesOnRenameProvider")),(0,o.kt)("p",null,"Boolean value to signify whether or not the client opens files when doing a\nrename."),(0,o.kt)("p",null,"Default: ",(0,o.kt)("inlineCode",{parentName:"p"},"false")),(0,o.kt)("h5",{id:"opennewwindowprovider"},(0,o.kt)("inlineCode",{parentName:"h5"},"openNewWindowProvider")),(0,o.kt)("p",null,"Boolean value signifying whether or not the client supports opening up a new\nwindow with the newly created project. Used in conjunction with the New Project\nProvider."),(0,o.kt)("p",null,"Default value: ",(0,o.kt)("inlineCode",{parentName:"p"},"false")),(0,o.kt)("h5",{id:"quickpickprovider"},(0,o.kt)("inlineCode",{parentName:"h5"},"quickPickProvider")),(0,o.kt)("p",null,"Boolean value to signify whether or not the client implements the\n",(0,o.kt)("a",{parentName:"p",href:"#metalsquickpick"},(0,o.kt)("inlineCode",{parentName:"a"},"metals/quickPick"))," extensions."),(0,o.kt)("p",null,"Default value: ",(0,o.kt)("inlineCode",{parentName:"p"},"false")),(0,o.kt)("h5",{id:"renamefilethreshold"},(0,o.kt)("inlineCode",{parentName:"h5"},"renameFileThreshold")),(0,o.kt)("p",null,"The max amount of files that you would like the client to open if the client is\na ",(0,o.kt)("inlineCode",{parentName:"p"},"openFilesOnRenameProvider"),"."),(0,o.kt)("p",null,"Default value: ",(0,o.kt)("inlineCode",{parentName:"p"},"300")),(0,o.kt)("h5",{id:"slowtaskprovider"},(0,o.kt)("inlineCode",{parentName:"h5"},"slowTaskProvider")),(0,o.kt)("p",null,"Possible values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"off")," (default): the ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/slowTask")," request is not supported."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"on"),": the ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/slowTask")," request is fully supported."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"status-bar"),": the ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/slowTask")," request is not supported, but send updates\nabout slow tasks via ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/status"),".")),(0,o.kt)("h5",{id:"statusbarprovider"},(0,o.kt)("inlineCode",{parentName:"h5"},"statusBarProvider")),(0,o.kt)("p",null,"Possible values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"off")," (default): the ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/status")," notification is not supported."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"on"),": the ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/status")," notification is supported."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"log-message"),": translate ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/status")," notifications to ",(0,o.kt)("inlineCode",{parentName:"li"},"window/logMessage"),"\nnotifications."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"show-message"),": translate ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/status")," notifications to\n",(0,o.kt)("inlineCode",{parentName:"li"},"window/showMessage")," show notifications however the client displays messages\nto the user.")),(0,o.kt)("h5",{id:"treeviewprovider"},(0,o.kt)("inlineCode",{parentName:"h5"},"treeViewProvider")),(0,o.kt)("p",null,"Boolean value signifying whether or not the client supports the\n",(0,o.kt)("a",{parentName:"p",href:"/metals/docs/integrations/tree-view-protocol"},"Tree View Protocol"),"."),(0,o.kt)("p",null,"Default value: ",(0,o.kt)("inlineCode",{parentName:"p"},"false")),(0,o.kt)("h4",{id:"experimental-capabilities"},"Experimental Capabilities"),(0,o.kt)("p",null,"All of the features that used to be set with ",(0,o.kt)("inlineCode",{parentName:"p"},"experimental")," can now all be set\nvia ",(0,o.kt)("inlineCode",{parentName:"p"},"InitializationOptions"),". This is the preferred way to configure Metals."),(0,o.kt)("h3",{id:"initialized"},(0,o.kt)("inlineCode",{parentName:"h3"},"initialized")),(0,o.kt)("p",null,"Triggers build server initialization and workspace indexing. The ",(0,o.kt)("inlineCode",{parentName:"p"},"initialized"),"\nnotification is critical for any Metals functionality to work."),(0,o.kt)("h3",{id:"shutdown"},(0,o.kt)("inlineCode",{parentName:"h3"},"shutdown")),(0,o.kt)("p",null,"It is very important that the client sends a shutdown request in order for\nMetals to clean up open resources."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"persists incremental compilation analysis files. Without a ",(0,o.kt)("inlineCode",{parentName:"li"},"shutdown")," hook,\nMetals will need to re-compile the entire workspace on next startup."),(0,o.kt)("li",{parentName:"ul"},"stops ongoing processes such as ",(0,o.kt)("inlineCode",{parentName:"li"},"sbt bloopInstall")),(0,o.kt)("li",{parentName:"ul"},"closes database connections")),(0,o.kt)("h3",{id:"exit"},(0,o.kt)("inlineCode",{parentName:"h3"},"exit")),(0,o.kt)("p",null,"Kills the process using ",(0,o.kt)("inlineCode",{parentName:"p"},"System.exit"),"."),(0,o.kt)("h3",{id:"cancelrequest"},(0,o.kt)("inlineCode",{parentName:"h3"},"$/cancelRequest")),(0,o.kt)("p",null,"Used by ",(0,o.kt)("inlineCode",{parentName:"p"},"metals/slowTask")," to notify when a long-running process has finished."),(0,o.kt)("h3",{id:"clientregistercapability"},(0,o.kt)("inlineCode",{parentName:"h3"},"client/registerCapability")),(0,o.kt)("p",null,"If the client declares the ",(0,o.kt)("inlineCode",{parentName:"p"},"workspace.didChangeWatchedFiles")," capability during\nthe ",(0,o.kt)("inlineCode",{parentName:"p"},"initialize")," request, then Metals follows up with a\n",(0,o.kt)("inlineCode",{parentName:"p"},"client/registerCapability")," request to register file watchers for certain glob\npatterns."),(0,o.kt)("h3",{id:"textdocumentdidopen"},(0,o.kt)("inlineCode",{parentName:"h3"},"textDocument/didOpen")),(0,o.kt)("p",null,"Triggers compilation in the build server for the build target containing the\nopened document. Related, see ",(0,o.kt)("inlineCode",{parentName:"p"},"metals/didFocusTextDocument"),"."),(0,o.kt)("h3",{id:"textdocumentdidchange"},(0,o.kt)("inlineCode",{parentName:"h3"},"textDocument/didChange")),(0,o.kt)("p",null,"Required to know the text contents of the current unsaved buffer."),(0,o.kt)("h3",{id:"textdocumentdidclose"},(0,o.kt)("inlineCode",{parentName:"h3"},"textDocument/didClose")),(0,o.kt)("p",null,"Cleans up resources."),(0,o.kt)("h3",{id:"textdocumentdidsave"},(0,o.kt)("inlineCode",{parentName:"h3"},"textDocument/didSave")),(0,o.kt)("p",null,"Triggers compilation in the build server and analyses if the build needs to be\nre-imported."),(0,o.kt)("h3",{id:"textdocumentpublishdiagnostics"},(0,o.kt)("inlineCode",{parentName:"h3"},"textDocument/publishDiagnostics")),(0,o.kt)("p",null,"Metals forwards diagnostics from the build server to the editor client.\nAdditionally, Metals publishes ",(0,o.kt)("inlineCode",{parentName:"p"},"Information")," diagnostics for unexpected\ncompilation errors when navigating external library sources."),(0,o.kt)("h3",{id:"textdocumentdefinition"},(0,o.kt)("inlineCode",{parentName:"h3"},"textDocument/definition")),(0,o.kt)("p",null,"Metals supports goto definition for workspace sources in addition to external\nlibrary sources."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Library sources live under the directory ",(0,o.kt)("inlineCode",{parentName:"li"},".metals/readonly")," and they are\nmarked as read-only to prevent the user from editing them."),(0,o.kt)("li",{parentName:"ul"},"The destination location can either be a Scala or Java source file. It is\nrecommended to have a Java language server installed to navigate Java sources.")),(0,o.kt)("h3",{id:"textdocumentreferences"},(0,o.kt)("inlineCode",{parentName:"h3"},"textDocument/references")),(0,o.kt)("p",null,"Metals finds symbol references for workspace sources but not external library\ndependencies."),(0,o.kt)("p",null,"LSP does not support streaming references so when project sources have not been\ncompiled at the point of a request, Metals returns immediately with potentially\nincomplete results and triggers a background cascade compilation to find new\nsymbol references. If new symbol references are discovered after the background\ncompilation completes, Metals sends a notification via ",(0,o.kt)("inlineCode",{parentName:"p"},"metals/status")," and\n",(0,o.kt)("inlineCode",{parentName:"p"},"window/logMessage"),' asking the user to run "find references" again.'),(0,o.kt)("h3",{id:"textdocumentdocumentsymbol"},(0,o.kt)("inlineCode",{parentName:"h3"},"textDocument/documentSymbol")),(0,o.kt)("p",null,"Returns ",(0,o.kt)("inlineCode",{parentName:"p"},"DocumentSymbol[]")," if the client declares support for hierarchical\ndocument symbol or ",(0,o.kt)("inlineCode",{parentName:"p"},"SymbolInformation[]")," otherwise."),(0,o.kt)("h3",{id:"textdocumentformatting"},(0,o.kt)("inlineCode",{parentName:"h3"},"textDocument/formatting")),(0,o.kt)("p",null,"Formats the sources with the ",(0,o.kt)("a",{parentName:"p",href:"https://scalameta.org/scalafmt/"},"Scalafmt")," version\nthat is declared in ",(0,o.kt)("inlineCode",{parentName:"p"},".scalafmt.conf"),"."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"when ",(0,o.kt)("inlineCode",{parentName:"li"},".scalafmt.conf")," is missing, Metals sends a ",(0,o.kt)("inlineCode",{parentName:"li"},"window/showMessageRequest"),"\nto create the file."),(0,o.kt)("li",{parentName:"ul"},"when ",(0,o.kt)("inlineCode",{parentName:"li"},".scalafmt.conf")," exists but doesn't declare a ",(0,o.kt)("inlineCode",{parentName:"li"},"version")," setting, Metals\nsends a ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/inputBox")," when supported (with fallback to\n",(0,o.kt)("inlineCode",{parentName:"li"},"window/showMessageRequest")," when unsupported) to prepend ",(0,o.kt)("inlineCode",{parentName:"li"},"version=$VERSION")," to\nthe ",(0,o.kt)("inlineCode",{parentName:"li"},".scalafmt.conf")," file."),(0,o.kt)("li",{parentName:"ul"},"the first format request is usually slow because Metals needs to download\nScalafmt artifacts from Maven Central. While the download happens, Metals adds\na message in the status bar via ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/status")," and detailed download progress\ninformation is logged to ",(0,o.kt)("inlineCode",{parentName:"li"},".metals/metals.log"),".")),(0,o.kt)("h3",{id:"textdocumenthover"},(0,o.kt)("inlineCode",{parentName:"h3"},"textDocument/hover")),(0,o.kt)("p",null,"Returns ",(0,o.kt)("inlineCode",{parentName:"p"},"Hover")," for specified text document and position - ",(0,o.kt)("a",{parentName:"p",href:"https://microsoft.github.io/language-server-protocol/specifications/specification-3-17/#textDocument_hover"},"lsp spec"),"."),(0,o.kt)("p",null,"Metals also support an extended version of this method that supports hover for selection range.\nThe extended stucture of request params is the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"interface HoverExtParams {\n  textDocument: TextDocumentIdentifier;\n  /** Either `position` or `range` should be specified */\n  position?: Position;\n  range?: Range;\n}\n")),(0,o.kt)("h3",{id:"workspacedidchangewatchedfiles"},(0,o.kt)("inlineCode",{parentName:"h3"},"workspace/didChangeWatchedFiles")),(0,o.kt)("p",null,"Optional. Metals uses a built-in file watcher for critical functionality such as\nGoto Definition so it is OK if an editor does not send\n",(0,o.kt)("inlineCode",{parentName:"p"},"workspace/didChangeWatchedFiles")," notifications."),(0,o.kt)("p",null,"Metals listens to ",(0,o.kt)("inlineCode",{parentName:"p"},"workspace/didChangeWatchedFiles")," notifications from the\neditor for nice-to-have but non-critical file watching events. Metals\nautomatically registers for the following glob patterns if the editor supports\ndynamic registration for file watching."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "watchers": [\n    {\n      "globPattern": "file:///to/workspace/*.sbt"\n    },\n    {\n      "globPattern": "file:///to/workspace/pom.xml"\n    },\n    {\n      "globPattern": "file:///to/workspace/*.sc"\n    },\n    {\n      "globPattern": "file:///to/workspace/*?.gradle"\n    },\n    {\n      "globPattern": "file:///to/workspace/*.gradle.kts"\n    },\n    {\n      "globPattern": "file:///to/workspace/project/*.{scala,sbt}"\n    },\n    {\n      "globPattern": "file:///to/workspace/project/project/*.{scala,sbt}"\n    },\n    {\n      "globPattern": "file:///to/workspace/project/build.properties"\n    }\n  ]\n}\n')),(0,o.kt)("p",null,"The editor is responsible for manually watching these file patterns if the\neditor does not support dynamic file watching registration but can still send\n",(0,o.kt)("inlineCode",{parentName:"p"},"workspace/didChangeWatchedFiles")," notifications."),(0,o.kt)("h3",{id:"workspaceexecutecommands"},(0,o.kt)("inlineCode",{parentName:"h3"},"workspace/executeCommands")),(0,o.kt)("p",null,"Used to trigger a ",(0,o.kt)("a",{parentName:"p",href:"#metals-server-commands"},"Metals server command"),"."),(0,o.kt)("h3",{id:"workspacedidchangeconfiguration"},(0,o.kt)("inlineCode",{parentName:"h3"},"workspace/didChangeConfiguration")),(0,o.kt)("p",null,"Used to update ",(0,o.kt)("a",{parentName:"p",href:"#metals-user-configuration"},"Metals user configuration"),"."),(0,o.kt)("h3",{id:"windowlogmessage"},(0,o.kt)("inlineCode",{parentName:"h3"},"window/logMessage")),(0,o.kt)("p",null,"Used to log non-critical and non-actionable information. The user is only\nexpected to use the logs for troubleshooting or finding metrics for how long\ncertain events take."),(0,o.kt)("h3",{id:"windowshowmessage"},(0,o.kt)("inlineCode",{parentName:"h3"},"window/showMessage")),(0,o.kt)("p",null,"Used to send critical but non-actionable notifications to the user. For\nnon-critical notifications, see ",(0,o.kt)("inlineCode",{parentName:"p"},"metals/status"),"."),(0,o.kt)("h3",{id:"windowshowmessagerequest"},(0,o.kt)("inlineCode",{parentName:"h3"},"window/showMessageRequest")),(0,o.kt)("p",null,"Used to send critical and actionable notifications to the user. To notify the\nuser about long running tasks that can be cancelled, the extension\n",(0,o.kt)("inlineCode",{parentName:"p"},"metals/slowTask")," is used instead."),(0,o.kt)("h2",{id:"metals-server-properties"},"Metals server properties"),(0,o.kt)("p",null,"There are various Metals server properties that can be configured through JVM\nsystem properties. A system property is passed to the server like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"# with `java` binary\njava -Dmetals.statistics=all ...\n# with `coursier bootstrap`\ncoursier bootstrap --java-opt -Dmetals.statistics=all ...\n")),(0,o.kt)("p",null,"Below are the available server properties:"),(0,o.kt)("h3",{id:"-dmetalsverbose"},(0,o.kt)("inlineCode",{parentName:"h3"},"-Dmetals.verbose")),(0,o.kt)("p",null,"Possible values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"off")," (default): don't log unnecessary details."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"on"),": emit very detailed logs, should only be used when debugging problems.")),(0,o.kt)("h3",{id:"-dmetalsstatistics"},(0,o.kt)("inlineCode",{parentName:"h3"},"-Dmetals.statistics")),(0,o.kt)("p",null,"By default, Metals logs only the most relevant metrics like time it takes to run\nsbt and import a workspace. The enable further metrics, update this property\nwith a comma separated list of the following supported values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"memory"),": print memory usage of the navigation index after build import."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"definition"),": print total time to respond to ",(0,o.kt)("inlineCode",{parentName:"li"},"textDocument/definition"),"\nrequests.")),(0,o.kt)("p",null,"Set the value to ",(0,o.kt)("inlineCode",{parentName:"p"},"-Dmetals.statistics=all")," to enable all statistics."),(0,o.kt)("h3",{id:"-dmetalsh2auto-server"},(0,o.kt)("inlineCode",{parentName:"h3"},"-Dmetals.h2.auto-server")),(0,o.kt)("p",null,"Possible values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"on")," (default): use\n",(0,o.kt)("a",{parentName:"li",href:"http://www.h2database.com/html/features.html#auto_mixed_mode"},"H2 ",(0,o.kt)("inlineCode",{parentName:"a"},"AUTO_SERVER=TRUE")," mode"),"\nto support multiple concurrent Metals servers in the same workspace. If this\noption is enabled, the Metals H2 database communicate to other concurrently\nrunning Metals servers via TCP through a free port. In case of failure to\nestablish a ",(0,o.kt)("inlineCode",{parentName:"li"},"AUTO_SERVER=TRUE")," connection, Metals falls back to\n",(0,o.kt)("inlineCode",{parentName:"li"},"AUTO_SERVER=FALSE"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"off"),": do not use use ",(0,o.kt)("inlineCode",{parentName:"li"},"AUTO_SERVER=TRUE"),". By disabling this option, it's not\npossible to run concurrent Metals servers in the same workspace directory. For\nexample, it's not possible to have both VS Code and Vim installed with Metals\nrunning in the same directory. In case there are multiple Metals servers\nrunning in the same workspace directory, Metals falls back to using an\nin-memory database resulting in a degraded user experience.")),(0,o.kt)("h3",{id:"-dmetalspcdebug"},(0,o.kt)("inlineCode",{parentName:"h3"},"-Dmetals.pc.debug")),(0,o.kt)("p",null,"Possible values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"off")," (default): do not log verbose debugging information for the presentation\ncompiler."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"on"),": log verbose debugging information for the presentation compiler.")),(0,o.kt)("h3",{id:"-dbloopsbtversion"},(0,o.kt)("inlineCode",{parentName:"h3"},"-Dbloop.sbt.version")),(0,o.kt)("p",null,'Version number of the sbt-bloop plugin to use for the "Install build" command.\nDefault value is ',(0,o.kt)("inlineCode",{parentName:"p"},"-Dbloop.sbt.version=1.4.13-50-8332ee9c"),"."),(0,o.kt)("p",null,"The below properties are also available as user configuration options. It's\npreferable to set these there:"),(0,o.kt)("h3",{id:"-dmetalsbloop-port"},(0,o.kt)("inlineCode",{parentName:"h3"},"-Dmetals.bloop-port")),(0,o.kt)("p",null,"Port number of the Bloop server to connect to. Should only be used if Bloop\nserver was setup in a custom way. Default value is ",(0,o.kt)("inlineCode",{parentName:"p"},"8212"),"."),(0,o.kt)("p",null,"Possible values are any allowed port number that the Bloop server is able to run\non."),(0,o.kt)("h2",{id:"metals-user-configuration"},"Metals user configuration"),(0,o.kt)("p",null,"Users can customize the Metals server through the LSP\n",(0,o.kt)("inlineCode",{parentName:"p"},"workspace/didChangeConfiguration")," notification. Unlike server properties, it is\nnormal for regular Metals users to configure these options."),(0,o.kt)("p",null,"User configuration options can optionally be provided via server properties\nusing the ",(0,o.kt)("inlineCode",{parentName:"p"},"-Dmetals.")," prefix. System properties may be helpful for editor\nclients that don't support ",(0,o.kt)("inlineCode",{parentName:"p"},"workspace/didChangeConfiguration"),". In case user\nconfiguration is defined both via system properties and\n",(0,o.kt)("inlineCode",{parentName:"p"},"workspace/didChangeConfiguration"),", then ",(0,o.kt)("inlineCode",{parentName:"p"},"workspace/didChangeConfiguration"),"\ntakes precedence."),(0,o.kt)("h3",{id:"java-home-directory"},"Java Home directory"),(0,o.kt)("p",null,"The Java Home directory used for indexing JDK sources and locating the ",(0,o.kt)("inlineCode",{parentName:"p"},"java")," binary."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"JAVA_HOME")," environment variable with fallback to ",(0,o.kt)("inlineCode",{parentName:"p"},"user.home")," system property."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "javaHome": "/Library/Java/JavaVirtualMachines/jdk1.8.0_192.jdk/Contents/Home"\n  }\n}\n')),(0,o.kt)("h3",{id:"sbt-script"},"sbt script"),(0,o.kt)("p",null,"Optional absolute path to an ",(0,o.kt)("inlineCode",{parentName:"p"},"sbt")," executable to use for running ",(0,o.kt)("inlineCode",{parentName:"p"},"sbt bloopInstall"),".\nBy default, Metals uses ",(0,o.kt)("inlineCode",{parentName:"p"},"java -jar sbt-launch.jar")," with an embedded launcher while respecting\n",(0,o.kt)("inlineCode",{parentName:"p"},".jvmopts")," and ",(0,o.kt)("inlineCode",{parentName:"p"},".sbtopts"),". Update this setting if your ",(0,o.kt)("inlineCode",{parentName:"p"},"sbt")," script requires more customizations\nlike using environment variables."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": empty string ",(0,o.kt)("inlineCode",{parentName:"p"},'""'),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "sbtScript": "/usr/local/bin/sbt"\n  }\n}\n')),(0,o.kt)("h3",{id:"gradle-script"},"Gradle script"),(0,o.kt)("p",null,"Optional absolute path to a ",(0,o.kt)("inlineCode",{parentName:"p"},"gradle")," executable to use for running ",(0,o.kt)("inlineCode",{parentName:"p"},"gradle bloopInstall"),".\nBy default, Metals uses gradlew with 5.3.1 gradle version. Update this setting if your ",(0,o.kt)("inlineCode",{parentName:"p"},"gradle")," script requires more customizations\nlike using environment variables."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": empty string ",(0,o.kt)("inlineCode",{parentName:"p"},'""'),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "gradleScript": "/usr/local/bin/gradle"\n  }\n}\n')),(0,o.kt)("h3",{id:"maven-script"},"Maven script"),(0,o.kt)("p",null,"Optional absolute path to a ",(0,o.kt)("inlineCode",{parentName:"p"},"maven")," executable to use for generating bloop config.\nBy default, Metals uses mvnw maven wrapper with 3.6.1 maven version. Update this setting if your ",(0,o.kt)("inlineCode",{parentName:"p"},"maven")," script requires more customizations"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": empty string ",(0,o.kt)("inlineCode",{parentName:"p"},'""'),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "mavenScript": "/usr/local/bin/mvn"\n  }\n}\n')),(0,o.kt)("h3",{id:"mill-script"},"Mill script"),(0,o.kt)("p",null,"Optional absolute path to a ",(0,o.kt)("inlineCode",{parentName:"p"},"mill")," executable to use for running ",(0,o.kt)("inlineCode",{parentName:"p"},"mill mill.contrib.Bloop/install"),".\nBy default, Metals uses mill wrapper script with 0.5.0 mill version. Update this setting if your ",(0,o.kt)("inlineCode",{parentName:"p"},"mill")," script requires more customizations\nlike using environment variables."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": empty string ",(0,o.kt)("inlineCode",{parentName:"p"},'""'),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "millScript": "/usr/local/bin/mill"\n  }\n}\n')),(0,o.kt)("h3",{id:"scalafmt-config-path"},"Scalafmt config path"),(0,o.kt)("p",null,"Optional custom path to the .scalafmt.conf file.\nShould be an absolute path and use forward slashes ",(0,o.kt)("inlineCode",{parentName:"p"},"/")," for file separators (even on Windows)."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": empty string ",(0,o.kt)("inlineCode",{parentName:"p"},'""'),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "scalafmtConfigPath": "project/.scalafmt.conf"\n  }\n}\n')),(0,o.kt)("h3",{id:"scalafix-config-path"},"Scalafix config path"),(0,o.kt)("p",null,"Optional custom path to the .scalafix.conf file.\nShould be an absolute path and use forward slashes ",(0,o.kt)("inlineCode",{parentName:"p"},"/")," for file separators (even on Windows)."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": empty string ",(0,o.kt)("inlineCode",{parentName:"p"},'""'),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "scalafixConfigPath": "project/.scalafix.conf"\n  }\n}\n')),(0,o.kt)("h3",{id:"ammonite-jvm-properties"},"Ammonite JVM Properties"),(0,o.kt)("p",null,"Optional list of JVM properties to pass along to the Ammonite server.\nEach property needs to be a separate item.\\n\\nExample: ",(0,o.kt)("inlineCode",{parentName:"p"},"-Xmx1G")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"-Xms100M"),'"'),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"[]"),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "ammoniteJvmProperties": ["-Xmx1G"]\n  }\n}\n')),(0,o.kt)("h3",{id:"excluded-packages"},"Excluded Packages"),(0,o.kt)("p",null,"Packages that will be excluded from completions, imports, and symbol searches."),(0,o.kt)("p",null,"Note that this is in addition to some default packages that are already excluded.\nThe default excluded packages are listed below:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"META-INF\nimages\ntoolbarButtonGraphics\njdk\nsun\noracle\njava.awt.desktop\norg.jcp\norg.omg\norg.graalvm\ncom.oracle\ncom.sun\ncom.apple\napple\ncom.sourcegraph.shaded\n")),(0,o.kt)("p",null,"If there is a need to remove one of the defaults, you are able to do so by including the\npackage in your list and prepending ",(0,o.kt)("inlineCode",{parentName:"p"},"--")," to it."),(0,o.kt)("p",null,"Example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'["--sun"]\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"[]"),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "excludedPackages": ["akka.actor.typed.javadsl"]\n  }\n}\n')),(0,o.kt)("h3",{id:"dont-generate-bloop-plugin-file-for-sbt"},"Don't generate Bloop plugin file for sbt"),(0,o.kt)("p",null,"If true, Metals will not generate ",(0,o.kt)("inlineCode",{parentName:"p"},"metals.sbt")," files under the assumption that sbt-bloop is already manually installed in the sbt build. Build import will fail with a 'not valid command bloopInstall' error in case Bloop is not manually installed in the build when using this option."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": false"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "bloopSbtAlreadyInstalled": false\n  }\n}\n')),(0,o.kt)("h3",{id:"version-of-bloop"},"Version of Bloop"),(0,o.kt)("p",null,"This version will be used for the Bloop build tool plugin, for any supported build tool,\nwhile importing in Metals as well as for running the embedded server"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": 1.4.13-50-8332ee9c"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "bloopVersion": "1.4.0-RC1"\n  }\n}\n')),(0,o.kt)("h3",{id:"should-display-lenses-with-links-to-super-methods"},"Should display lenses with links to super methods"),(0,o.kt)("p",null,"Super method lenses are visible above methods definition that override another methods. Clicking on a lens jumps to super method definition.\nDisabled lenses are not calculated for opened documents which might speed up document processing."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": false"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "superMethodLensesEnabled": false\n  }\n}\n')),(0,o.kt)("h3",{id:"should-display-type-annotations-for-inferred-types"},"Should display type annotations for inferred types"),(0,o.kt)("p",null,"When this option is enabled, each method that can have inferred types has them\ndisplayed either as additional decorations if they are supported by the editor or\nshown in the hover."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": false"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "showInferredType": false\n  }\n}\n')),(0,o.kt)("h3",{id:"should-display-implicit-parameter-at-usage-sites"},"Should display implicit parameter at usage sites"),(0,o.kt)("p",null,"When this option is enabled, each method that has implicit arguments has them\ndisplayed either as additional decorations if they are supported by the editor or\nshown in the hover."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": false"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "showImplicitArguments": false\n  }\n}\n')),(0,o.kt)("h3",{id:"should-display-implicit-conversion-at-usage-sites"},"Should display implicit conversion at usage sites"),(0,o.kt)("p",null,"When this option is enabled, each place where an implicit method or class is used has it\ndisplayed either as additional decorations if they are supported by the editor or\nshown in the hover."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": false"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "showImplicitConversionsAndClasses": false\n  }\n}\n')),(0,o.kt)("h3",{id:"should-try-adjust-indentation-on-range-formatting"},"Should try adjust indentation on range formatting."),(0,o.kt)("p",null,"When this option is enabled, when user pastes any snippet into a Scala file, Metals\nwill try to adjust the indentation to that of the current cursor."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": false"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "enableIndentOnPaste": false\n  }\n}\n')),(0,o.kt)("h3",{id:"remote-language-server"},"Remote language server"),(0,o.kt)("p",null,"A URL pointing to an endpoint that implements a remote language server."),(0,o.kt)("p",null,"See ",(0,o.kt)("a",{parentName:"p",href:"https://scalameta.org/metals/docs/contributors/remote-language-server.html"},"https://scalameta.org/metals/docs/contributors/remote-language-server.html")," for\ndocumentation on remote language servers."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": empty string ",(0,o.kt)("inlineCode",{parentName:"p"},'""'),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "remoteLanguageServer": "https://language-server.company.com/message"\n  }\n}\n')),(0,o.kt)("h3",{id:"default-fallback-scala-version"},"Default fallback Scala version"),(0,o.kt)("p",null,"The Scala compiler version that is used as the default or fallback in case a file\ndoesn't belong to any build target or the specified Scala version isn't supported by Metals.\nThis applies to standalone Scala files, worksheets, and Ammonite scripts."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": 3.1.1"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "fallbackScalaVersion": 3.1.1\n  }\n}\n')),(0,o.kt)("h3",{id:"test-ui-used-for-tests-and-test-suites"},"Test UI used for tests and test suites"),(0,o.kt)("p",null,"Default way of handling tests and test suites."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": Code Lenses"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "testUserInterface": test explorer\n  }\n}\n')),(0,o.kt)("h3",{id:"eclipse-java-formatter-config-path"},"Eclipse Java formatter config path"),(0,o.kt)("p",null,"Optional custom path to the eclipse-formatter.xml file.\nShould be an absolute path and use forward slashes ",(0,o.kt)("inlineCode",{parentName:"p"},"/")," for file separators (even on Windows)."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": empty string ",(0,o.kt)("inlineCode",{parentName:"p"},'""'),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "javaFormat.eclipseConfigPath": "formatters/eclipse-formatter.xml"\n  }\n}\n')),(0,o.kt)("h3",{id:"eclipse-java-formatting-profile"},"Eclipse Java formatting profile"),(0,o.kt)("p",null,"If the Eclipse formatter file contains more than one profile then specify the required profile name."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Default"),": empty string ",(0,o.kt)("inlineCode",{parentName:"p"},'""'),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Example"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metals": {\n    "javaFormat.eclipseProfile": "GoogleStyle"\n  }\n}\n')),(0,o.kt)("h2",{id:"metals-server-commands"},"Metals server commands"),(0,o.kt)("p",null,"The client can trigger one of the following commands through the\n",(0,o.kt)("inlineCode",{parentName:"p"},"workspace/executeCommand")," request."),(0,o.kt)("h3",{id:"analyze-stacktrace"},"Analyze stacktrace"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"analyze-stacktrace"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ","[string]",", where the string is a stacktrace."),(0,o.kt)("p",null,"Converts provided stacktrace in the parameter to a format that contains links\nto locations of places where the exception was raised."),(0,o.kt)("p",null,"If the configuration parameter of the client ",(0,o.kt)("inlineCode",{parentName:"p"},"commandInHtmlFormat")," is set\nthen client is requested to display html with links\nalready pointing to proper locations in user codebase.\nOtherwise client will display simple scala file\nbut with code lenses that direct user to proper location in codebase."),(0,o.kt)("h3",{id:"switch-build-server"},"Switch build server"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"bsp-switch"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"null")),(0,o.kt)("p",null,"Prompt the user to select a new build server to connect to."),(0,o.kt)("p",null,"This command does nothing in case there are less than two installed build\nservers on the computer. In case the user has multiple BSP servers installed\nthen Metals will prompt the user to select which server to use."),(0,o.kt)("h3",{id:"connect-to-build-server"},"Connect to build server"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"build-connect"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"null")),(0,o.kt)("p",null,"Establish a new connection to the build server and reindex the workspace."),(0,o.kt)("p",null,"This command can be helpful in scenarios when Metals feels unresponsive, for example\nwhen reopening Metals after the computer it has been sleeping."),(0,o.kt)("h3",{id:"cancel-compilation"},"Cancel compilation"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"compile-cancel"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"null")),(0,o.kt)("p",null,"Cancel the currently ongoing compilation, if any."),(0,o.kt)("h3",{id:"cascade-compile"},"Cascade compile"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"compile-cascade"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"null")),(0,o.kt)("p",null,"Compile the current open files along with all build targets in this workspace that depend on those files."),(0,o.kt)("p",null,"By default, Metals compiles only the current build target and its dependencies when saving a file.\nRun the cascade compile task to additionally compile the inverse dependencies of the current build target.\nFor example, if you change the API in main sources and run cascade compile then it will also compile the\ntest sources that depend on main."),(0,o.kt)("h3",{id:"clean-compile-workspace"},"Clean compile workspace"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"compile-clean"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"null")),(0,o.kt)("p",null,"Recompile all build targets in this workspace."),(0,o.kt)("p",null,"By default, Metals compiles the files incrementally. In case of any compile artifacts corruption\nthis command might be run to make sure everything is recompiled correctly."),(0,o.kt)("h3",{id:"copy-worksheet-output"},"Copy Worksheet Output"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"copy-worksheet-output"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ","[uri]",", the uri of the worksheet that you'd like to copy the contents of."),(0,o.kt)("p",null,"Copy the contents of a worksheet to your local buffer."),(0,o.kt)("p",null,"Note: This command returns the contents of the worksheet, and the LSP client\nis in charge of taking that content and putting it into your local buffer."),(0,o.kt)("h3",{id:"discover-tests"},"Discover tests"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"discover-tests"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),":\nAn object with uri, when request is meant to discover test cases for uri"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},"{\n  uri: file:///home/dev/foo/Bar.scala\n}\n")),(0,o.kt)("p",null,"or empty object if request is meant to discover all test suites"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},"{}\n")),(0,o.kt)("p",null,"Discovers all tests in project or a file.\nSee ClientCommands.UpdateTestExplorer to see how response looks like."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'\n\n### Extract member definition\n**Command**: `"extract-member-definition"`\n\n**Arguments**: This command should be sent in with the LSP [`TextDocumentPositionParams`](https://microsoft.github.io/language-server-protocol/specifications/specification-current/#textDocumentPositionParams)\n\n\nWhenever a user chooses a code action to extract a definition of a Class/Trait/Object/Enum this\ncommand is later ran to extract the code and create a new file with it\n\n\n### Generate BSP Config\n**Command**: `"generate-bsp-config"`\n\n**Arguments**: [string], name of the build server.\n\nChecks to see if your build tool can serve as a BSP server. If so, generate\nthe necessary BSP config to connect to the server. If there is more than one\nbuild tool for a workspace, you can then choose the desired one and that\none will be used to generate the config.\n\nAfter the config is generated, Metals will attempt to auto-connect to it.\n\nThe build servers that Metals knows how to detect and start:\n - sbt\n - mill-bsp\n\nNote: while Metals does know how to start Bloop, Bloop will be started when you trigger a build\nimport or when you use `bsp-switch` to switch to Bloop.\n\n\n### Goto location for position\n**Command**: `"goto-position"`\n\n**Arguments**: [location], where the location is a lsp location object.\n\nMove the cursor to the location provided in arguments.\nIt simply forwards request to client.\n\n\n\n### Go to super method/field definition\n**Command**: `"goto-super-method"`\n\n**Arguments**: This command should be sent in with the LSP [`TextDocumentPositionParams`](https://microsoft.github.io/language-server-protocol/specifications/specification-current/#textDocumentPositionParams)\n\n\nJumps to super method/field definition of a symbol under cursor according to inheritance rules.\nWhen A {override def x()} <:< B <:< C {def x()} and on method \'A.x\' it will jump directly to \'C.x\'\nas method x() is not overridden in B.\nIf symbol is a reference of a method it will jump to a definition.\nIf symbol under cursor is invalid or does not override anything then command is ignored.\n\n\n\n### Goto location for symbol\n**Command**: `"goto"`\n\n**Arguments**: [string], where the string is a SemanticDB symbol.\n\nMove the cursor to the definition of the argument symbol.\n\n\n\n### Import build\n**Command**: `"build-import"`\n\n**Arguments**: `null`\n\nImport the latest changes from the build to for example pick up new library dependencies.\n\nBy default, Metals automatically prompts you to import the build when sources of the build change.\nUse this command to manually trigger an import build instead of relying on the automatic prompt.\n\n\n### Insert inferred type of a value\n**Command**: `"insert-inferred-type"`\n\n**Arguments**: This command should be sent in with the LSP [`TextDocumentPositionParams`](https://microsoft.github.io/language-server-protocol/specifications/specification-current/#textDocumentPositionParams)\n\n\nWhenever a user chooses code action to insert the inferred type this command is later ran to \ncalculate the type and insert it in the correct location.\n\n\n### Create new scala file\n**Command**: `"new-scala-file"`\n\n**Arguments**: [string[]], where the first is a directory location for the new file.\nThe second and third positions correspond to the file name and file type to allow for quick\ncreation of a file if all are present.\n\n\nCreate and open new Scala file.\n\nThe currently allowed Scala file types that ca be passed in are:\n\n - scala-file (Empty file)\n - scala-class (Class)\n - scala-case-class (Case Class)\n - scala-enum (Enum)\n - scala-object (Object)\n - scala-trait (Trait)\n - scala-package-object (Package Object)\n - scala-worksheet (Worksheet)\n - ammonite-script (Ammonite Script)\n\nNote: requires \'metals/inputBox\' capability from language client.\n\n\n### Create new java file\n**Command**: `"new-java-file"`\n\n**Arguments**: [string[]], where the first is a directory location for the new file.\nThe second and third positions correspond to the file name and file type to allow for quick\ncreation of a file if all are present.\n\n\nCreate and open a new Java file.\n\nThe currently allowed Java file types that ca be passed in are:\n\n - java-class (Class)\n - java-interface (Interface)\n - java-enum (Enum)\n - java-record (Record)\n\nNote: requires \'metals/inputBox\' capability from language client.\n\n\n### New Scala Project\n**Command**: `"new-scala-project"`\n\n**Arguments**: `null`\n\nCreate a new Scala project using one of the available g8 templates. \nThis includes simple projects as well as samples for most of the popular Scala frameworks.\nThe command reuses the Metals quick pick extension to work and can function with `window/showMessageRequest`, \nhowever the experience will not be optimal in that case. Some editors might also offer to open the newly created\nproject via `openNewWindowProvider`, but it is not necessary for the main functionality to work. \n\n\n### Restart presentation compiler\n**Command**: `"presentation-compiler-restart"`\n\n**Arguments**: `null`\n\nRestart running presentation compiler instances.\n\nMetals automatically restarts the presentation compiler after every successful compilation\nin the build tool so this command should not be needed for normal usage. Please report\nan issue if you need to use this command.\n\n\n### Reset Choice Popup\n**Command**: `"reset-choice"`\n\n**Arguments**: [string?], where string is a choice value.\n\nResetChoicePopup command allows you to reset a decision you made about different settings.\nE.g. If you choose to import workspace with sbt you can decide to reset and change it again.\n\nProvided string is optional but if present it must be one of defined in `PopupChoiceReset.scala`\nIf a choice is not provided it will execute interactive mode where user is prompt to select\nwhich choice to reset.\n\n\n### Restart build server\n**Command**: `"build-restart"`\n\n**Arguments**: `null`\n\nUnconditionally stop the current running Bloop server and start a new one using Bloop launcher\n\n### Run doctor\n**Command**: `"doctor-run"`\n\n**Arguments**: `null`\n\nOpen the Metals doctor to troubleshoot potential problems with the build.\n\nThis command can be helpful in scenarios where features are not working as expected such\nas compile errors are not appearing or completions are not correct.\n\n\n### Decode file\n**Command**: `"file-decode"`\n\n**Arguments**: [uri], uri of the file with any parameters required for decoding.\nExamples:\n- javap:\n')),(0,o.kt)("p",null,"  metalsDecode:file:///somePath/someFile.java.javap\nmetalsDecode:file:///somePath/someFile.scala.javap\nmetalsDecode:file:///somePath/someFile.class.javap\nmetalsDecode:file:///somePath/someFile.java.javap-verbose\nmetalsDecode:file:///somePath/someFile.scala.javap-verbose\nmetalsDecode:file:///somePath/someFile.class.javap-verbose"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"- semanticdb:\n")),(0,o.kt)("p",null,"  metalsDecode:file:///somePath/someFile.java.semanticdb-compact\nmetalsDecode:file:///somePath/someFile.java.semanticdb-detailed\nmetalsDecode:file:///somePath/someFile.scala.semanticdb-compact\nmetalsDecode:file:///somePath/someFile.scala.semanticdb-detailed\nmetalsDecode:file:///somePath/someFile.java.semanticdb.semanticdb-compact\nmetalsDecode:file:///somePath/someFile.java.semanticdb.semanticdb-detailed\nmetalsDecode:file:///somePath/someFile.scala.semanticdb.semanticdb-compact\nmetalsDecode:file:///somePath/someFile.scala.semanticdb.semanticdb-detailed"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"- tasty:\n")),(0,o.kt)("p",null,"  metalsDecode:file:///somePath/someFile.scala.tasty-decoded\nmetalsDecode:file:///somePath/someFile.tasty.tasty-decoded"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"- jar:\n")),(0,o.kt)("p",null,"  metalsDecode:jar:file:///somePath/someFile-sources.jar!/somePackage/someFile.java"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"- build target:\n")),(0,o.kt)("p",null,"  metalsDecode:file:///workspacePath/buildTargetName.metals-buildtarget"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"\nResponse:\n```ts\ninterface DecoderResponse {\nrequestedUri: string;\nvalue?: string;\nerror?: string\n}\n")),(0,o.kt)("p",null,"Decode a file into a human readable format."),(0,o.kt)("p",null,"Compilation involves various binary files that can't be read directly\nin a text editor so they need to be decoded into a human readable format.\nExamples include ",(0,o.kt)("inlineCode",{parentName:"p"},".class")," and ",(0,o.kt)("inlineCode",{parentName:"p"},".semanticdb"),"."),(0,o.kt)("h3",{id:"disconnect-to-build-server"},"Disconnect to build server"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"build-disconnect"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"null")),(0,o.kt)("p",null,"Unconditionally cancel existing build server connection without reconnecting"),(0,o.kt)("h3",{id:"list-build-targets"},"List build targets"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"list-build-targets"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"null")),(0,o.kt)("p",null,"Retrieve a list of build targets for the workspace."),(0,o.kt)("h3",{id:"scan-sources"},"Scan sources"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"sources-scan"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"null")),(0,o.kt)("p",null,"Walk all files in the workspace and index where symbols are defined."),(0,o.kt)("p",null,"Is automatically run once after ",(0,o.kt)("inlineCode",{parentName:"p"},"initialized")," notification and incrementally\nupdated on file watching events. A language client that doesn't support\nfile watching can run this manually instead. It should not be much slower\nthan walking the entire file tree and reading ",(0,o.kt)("inlineCode",{parentName:"p"},"*.scala")," files to string,\nindexing itself is cheap."),(0,o.kt)("h3",{id:"start-ammonite-build-server"},"Start Ammonite build server"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"ammonite-start"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"null")),(0,o.kt)("p",null,"Start Ammonite build server"),(0,o.kt)("h3",{id:"start-debug-adapter"},"Start debug adapter"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"debug-adapter-start"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": DebugSessionParameters object\nExample:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "targets": ["mybuild://workspace/foo/?id=foo"],\n   dataKind: "scala-main-class",\n   data: {\n      className: "com.foo.App"\n   }\n}\n')),(0,o.kt)("p",null,"or DebugUnresolvedMainClassParams object\nExample:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n   mainClass: "com.foo.App",\n   buildTarget: "foo",\n   args: ["bar"],\n   jvmOptions: ["-Dfile.encoding=UTF-16"],\n   env: {"NUM" : "123"},\n   envFile: ".env"\n}\n')),(0,o.kt)("p",null,"or DebugUnresolvedTestClassParams object\nExample:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n   testClass: "com.foo.FooSuite",\n   buildTarget: "foo"\n}\n')),(0,o.kt)("p",null,"Start debug adapter"),(0,o.kt)("h3",{id:"stop-ammonite-build-server"},"Stop Ammonite build server"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"ammonite-stop"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"null")),(0,o.kt)("p",null,"Stop Ammonite build server"),(0,o.kt)("h3",{id:"go-to-super-methodfield-definition-in-hierarchy"},"Go to super method/field definition in hierarchy"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"super-method-hierarchy"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": This command should be sent in with the LSP ",(0,o.kt)("a",{parentName:"p",href:"https://microsoft.github.io/language-server-protocol/specifications/specification-current/#textDocumentPositionParams"},(0,o.kt)("inlineCode",{parentName:"a"},"TextDocumentPositionParams"))),(0,o.kt)("p",null,"When user executes this command it will calculate inheritance hierarchy of a class that contains given method.\nThen it will filter out classes not overriding given method and a list using 'metalsQuickPick' will be\ndisplayed to which super method user would like to go to.\nCommand has no effect on other symbols than method definition.\nQuickPick will show up only if more than one result is found."),(0,o.kt)("h2",{id:"metals-client-commands"},"Metals client commands"),(0,o.kt)("p",null,"The Metals server can send one of the following client commands if the client\nsupports the ",(0,o.kt)("inlineCode",{parentName:"p"},"metals/executeClientCommand")," notification,"),(0,o.kt)("h3",{id:"open-a-specified-folder-either-in-the-same-or-new-window"},"Open a specified folder either in the same or new window"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"metals-open-folder"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": An object with ",(0,o.kt)("inlineCode",{parentName:"p"},"uri")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"newWindow")," fields.\nExample: "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "uri": "file://path/to/directory",\n  "newWindow": true\n}\n')),(0,o.kt)("p",null,"Open a new window with the specified directory."),(0,o.kt)("h3",{id:"run-doctor"},"Run doctor"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"metals-doctor-run"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"string"),", the HTML to display in the focused window."),(0,o.kt)("p",null,"Focus on a window displaying troubleshooting help from the Metals doctor."),(0,o.kt)("p",null,"If ",(0,o.kt)("inlineCode",{parentName:"p"},"doctorProvider")," is set to ",(0,o.kt)("inlineCode",{parentName:"p"},'"json"')," then the schema is as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},"export interface DoctorOutput {\n  /** Metals Doctor title */\n  title: string;\n  /** Version of the doctor json format, 0 if empty\n   * The latest version is: 2\n   */\n  version: String;\n  /**\n   * Contains decisions that were made about what build tool or build server\n   * the user has chosen. There is also other brief information about understanding\n   * the Doctor placed in here as well.\n   */\n   headerText: string;\n   /**\n    * If build targets are detected in your workspace, they will be listed here with\n    * the status of related functionality of Metals for each build target.\n    */\n   targets?: DoctorBuildTarget[];\n   /** Messages given if build targets cannot be found */\n   messages?: DoctorRecommendation[];\n   /** Messages given if build targets cannot be found */\n   messages?: DoctorRecommendation[];\n   /** Explanations for the various statuses present in the doctor */\n   explanations?: DoctorExplanation[];\n}\n\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},"export interface DoctorBuildTarget {\n  /** Name of the build target */\n  buildTarget: string;\n  /** Status of compilation for build this build target */\n  compilationStatus: string;\n  /** Can contain Scala version, sbt version or Java */\n  targetType: string;\n  /** Status of diagnostics */\n  diagnostics: string;\n  /** Status of completions, hovers and other interactive features*/\n  interactive: string;\n  /** Status of semanticdb indexes */\n  semanticdb: string;\n  /** Status of debugging */\n  debugging: string;\n  /** Status of java support */\n  java: string;\n  /** Any recommendations in how to fix any issues that are found above */\n  recommendation: string;\n}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},"export interface DoctorRecommendation {\n  /** Title of the recommendation */\n  title: string;\n  /** Recommendations related to the found issue. */\n  recommendations: string[]\n}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},"export interface DoctorExplanation {\n  /** Title of the explanation */\n  title: string;\n  /** Explanations of statuses that can be found in the doctor  */\n  recommendations: string[]\n}\n")),(0,o.kt)("h3",{id:"reload-doctor"},"Reload doctor"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"metals-doctor-reload"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"string"),", the HTML to display in the focused window."),(0,o.kt)("p",null,"Reload the HTML contents of an open Doctor window, if any. Should be ignored if there is no open doctor window.\nIf ",(0,o.kt)("inlineCode",{parentName:"p"},"doctorProvider")," is set to ",(0,o.kt)("inlineCode",{parentName:"p"},'"json"'),", then the schema is the same as found above in ",(0,o.kt)("inlineCode",{parentName:"p"},'"metals-run-doctor"')),(0,o.kt)("h3",{id:"toggle-logs"},"Toggle logs"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"metals-logs-toggle"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"null")),(0,o.kt)("p",null,"Focus or remove focus on the output logs reported by the server via ",(0,o.kt)("inlineCode",{parentName:"p"},"window/logMessage"),"."),(0,o.kt)("p",null,'In VS Code, this opens the "output" channel for the Metals extension.'),(0,o.kt)("h3",{id:"open-problems"},"Open problems"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"metals-diagnostics-focus"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"null")),(0,o.kt)("p",null,"Focus on the window that lists all published diagnostics."),(0,o.kt)("p",null,'In VS Code, this opens the "problems" window.'),(0,o.kt)("h3",{id:"goto-location"},"Goto location"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"metals-goto-location"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": First required parameter is LSP ",(0,o.kt)("inlineCode",{parentName:"p"},"Location")," object with ",(0,o.kt)("inlineCode",{parentName:"p"},"uri")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"range")," fields.\nSecond parameter is optional and has signature ",(0,o.kt)("inlineCode",{parentName:"p"},"otherWindow: Boolean"),".\nIt gives a hint to client that if possible it would be good to open location in\nanother buffer/window.\nExample: "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'[{\n  "uri": "file://path/to/Definition.scala",\n  "range": {\n    "start": {"line": 194, "character": 0},\n    "end":   {"line": 194, "character": 1}\n  },\n  "otherWindow" : true\n},\n]\n')),(0,o.kt)("p",null,"Move the cursor focus to the provided location"),(0,o.kt)("h3",{id:"echo-command"},"Echo command"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"metals-echo-command"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"string"),", the command ID to execute on the client."),(0,o.kt)("p",null,"A client command that should be forwarded back to the Metals server."),(0,o.kt)("p",null,"Metals may register commands in client UIs like tree view nodes that should be\nforwarded back to the Metals server if the client clicks on the UI elements."),(0,o.kt)("h3",{id:"refresh-model"},"Refresh model"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"metals-model-refresh"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"null")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note"),": This request is deprecated and Metals will favor ",(0,o.kt)("a",{parentName:"p",href:"https://microsoft.github.io/language-server-protocol/specifications/specification-3-16/#codeLens_refresh"},"Code Lens Refresh Request")," if supported by the client."),(0,o.kt)("p",null,"Notifies the client that the model has been updated and it\nshould be refreshed (e.g. by resending code lens request)"),(0,o.kt)("h3",{id:"show-the-stacktrace-in-the-client"},"Show the stacktrace in the client."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"metals-show-stacktrace"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ","[string]",", the markdown representation of the stacktrace"),(0,o.kt)("p",null,"Show the stacktrace modified with links to specific files."),(0,o.kt)("h3",{id:"copy-worksheet-output-1"},"Copy Worksheet Output"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"metals.copy-worksheet-output"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": ","[uri]",", the uri of the worksheet that you'd like to copy the contents of."),(0,o.kt)("p",null,"Copy the contents of a worksheet to your local buffer."),(0,o.kt)("p",null,"Note: This command should execute the copy-worksheet-output\nserver command to get the output to copy into the buffer."),(0,o.kt)("p",null,"Server will attempt to create code lens with this command if ",(0,o.kt)("inlineCode",{parentName:"p"},"copyWorksheetOutputProvider")," option is set."),(0,o.kt)("h3",{id:"start-run-session"},"Start run session"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"metals-run-session-start"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": DebugSessionParameters object. It should be forwarded\nto the debug-adapter-start command as is."),(0,o.kt)("p",null,"Example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "targets": ["mybuild://workspace/foo/?id=foo"],\n   dataKind: "scala-main-class",\n   data: {\n      className: "com.foo.App"\n   }\n}\n')),(0,o.kt)("p",null,"Starts a run session. The address of a new Debug Adapter can be obtained\nby using the debug-adapter-start metals server command\nwith the same arguments as provided to this command."),(0,o.kt)("h3",{id:"start-debug-session"},"Start debug session"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Command"),": ",(0,o.kt)("inlineCode",{parentName:"p"},'"metals-debug-session-start"')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Arguments"),": DebugSessionParameters object. It should be forwarded\nto the debug-adapter-start command as is."),(0,o.kt)("p",null,"Example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "targets": ["mybuild://workspace/foo/?id=foo"],\n   dataKind: "scala-main-class",\n   data: {\n      className: "com.foo.App"\n   }\n}\n')),(0,o.kt)("p",null,"Starts a debug session. The address of a new Debug Adapter can be obtained\nby using the debug-adapter-start metals server command\nwith the same arguments as provided to this command."),(0,o.kt)("h2",{id:"metals-http-client"},"Metals HTTP client"),(0,o.kt)("p",null,"Metals has an optional web interface that can be used to trigger server commands\nand respond to server requests. This interface is not intended for regular\nusers, it exists only to help editor plugin authors integrate with Metals."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/t5RJ3q6.png",alt:"Metals http client"})),(0,o.kt)("p",null,"The server is enabled by passing the ",(0,o.kt)("inlineCode",{parentName:"p"},"-Dmetals.http=on")," system property. The\nserver runs by default at ",(0,o.kt)("a",{parentName:"p",href:"http://localhost:5031/"},(0,o.kt)("inlineCode",{parentName:"a"},"http://localhost:5031")),".\nWhen the port 5031 is taken the next free increment is chosen instead (5032,\n5033, ...)."),(0,o.kt)("h2",{id:"metals-lsp-extensions"},"Metals LSP extensions"),(0,o.kt)("p",null,"Editor clients can opt into receiving Metals-specific JSON-RPC requests and\nnotifications. Metals extensions are not defined in LSP and are not strictly\nrequired for the Metals server to function but it is recommended to implement\nthem to improve the user experience."),(0,o.kt)("p",null,"To enable Metals extensions, start the main process with the system property\n",(0,o.kt)("inlineCode",{parentName:"p"},"-Dmetals.extensions=true"),"."),(0,o.kt)("h3",{id:"debug-adapter-protocol"},"Debug Adapter Protocol"),(0,o.kt)("p",null,"Metals implements and additional protocol for running and debugging inside the\neditor, see the\n",(0,o.kt)("a",{parentName:"p",href:"../integrations/debug-adapter-protocol.md"},"Debug Adapter Protocol"),"."),(0,o.kt)("h3",{id:"tree-view-protocol"},"Tree View Protocol"),(0,o.kt)("p",null,"Metals implements several custom JSON-RPC endpoints related to rendering tree\nviews in the editor client, the\n",(0,o.kt)("a",{parentName:"p",href:"../integrations/tree-view-protocol.md"},"Tree View Protocol"),"."),(0,o.kt)("h3",{id:"decoration-protocol"},"Decoration Protocol"),(0,o.kt)("p",null,"Metals implements an LSP extension to display non-editable text in the editor,\nsee the ",(0,o.kt)("a",{parentName:"p",href:"../integrations/decoration-protocol.md"},"Decoration Protocol"),"."),(0,o.kt)("h3",{id:"metalsslowtask"},(0,o.kt)("inlineCode",{parentName:"h3"},"metals/slowTask")),(0,o.kt)("p",null,"The Metals slow task request is sent from the server to the client to notify the\nstart of a long running process with unknown estimated total time. A\n",(0,o.kt)("inlineCode",{parentName:"p"},"cancel: true")," response from the client cancels the task. A ",(0,o.kt)("inlineCode",{parentName:"p"},"$/cancelRequest"),"\nrequest from the server indicates that the task has completed."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/nsjWHWR.gif",alt:"Metals slow task"})),(0,o.kt)("p",null,"The difference between ",(0,o.kt)("inlineCode",{parentName:"p"},"metals/slowTask")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"window/showMessageRequest")," is that\n",(0,o.kt)("inlineCode",{parentName:"p"},"slowTask")," is time-sensitive and the interface should display a timer for how\nlong the task has been running while ",(0,o.kt)("inlineCode",{parentName:"p"},"showMessageRequest")," is static."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Request"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"method: ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/slowTask")),(0,o.kt)("li",{parentName:"ul"},"params: ",(0,o.kt)("inlineCode",{parentName:"li"},"MetalsSlowTaskParams")," defined as follows:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},'interface MetalsSlowTaskParams {\n  /** The name of this slow task */\n  message: string;\n  /**\n   * If true, the log output from this task does not need to be displayed to the user.\n   *\n   * In VS Code, the Metals "Output channel" is not toggled when this flag is true.\n   */\n  quietLogs?: boolean;\n  /** Time that has elapsed since the begging of the task. */\n  secondsElapsed?: number;\n}\n')),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Response"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"result: ",(0,o.kt)("inlineCode",{parentName:"li"},"MetalsSlowTaskResponse")," defined as follows")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"interface MetalsSlowTaskResult {\n  /**\n   * If true, cancel the running task.\n   * If false, the user dismissed the dialogue but want to\n   * continue running the task.\n   */\n  cancel: boolean;\n}\n")),(0,o.kt)("h3",{id:"metalsstatus"},(0,o.kt)("inlineCode",{parentName:"h3"},"metals/status")),(0,o.kt)("p",null,"The Metals status notification is sent from the server to the client to notify\nabout non-critical and non-actionable events that are happening in the server.\nMetals status notifications are a complement to ",(0,o.kt)("inlineCode",{parentName:"p"},"window/showMessage")," and\n",(0,o.kt)("inlineCode",{parentName:"p"},"window/logMessage"),". Unlike ",(0,o.kt)("inlineCode",{parentName:"p"},"window/logMessage"),", status notifications should\nalways be visible in the user interface. Unlike ",(0,o.kt)("inlineCode",{parentName:"p"},"window/showMessage"),", status\nnotifications are not critical meaning that they should not demand too much\nattention from the user."),(0,o.kt)("p",null,"In general, Metals uses status notifications to update the user about ongoing\nevents in the server such as batch compilation in the build server or when a\nsuccessful connection was established with the build server."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/XX9CLRH.gif",alt:"Metals status bar"})),(0,o.kt)("p",null,'The "\ud83d\ude80 Imported build" and "\ud83d\udd04 Compiling explorer" messages at the bottom of\nthe window are ',(0,o.kt)("inlineCode",{parentName:"p"},"metals/status")," notifications."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Notification"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"method: ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/status")),(0,o.kt)("li",{parentName:"ul"},"params: ",(0,o.kt)("inlineCode",{parentName:"li"},"MetalsStatusParams")," defined as follows:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"interface MetalsStatusParams {\n  /** The text to display in the status bar. */\n  text: string;\n  /** If true, show the status bar. */\n  show?: boolean;\n  /** If true, hide the status bar. */\n  hide?: boolean;\n  /** If set, display this message when user hovers over the status bar. */\n  tooltip?: string;\n  /** If set, execute this command when the user clicks on the status bar item. */\n  command?: string;\n}\n")),(0,o.kt)("h3",{id:"metalsdidfocustextdocument"},(0,o.kt)("inlineCode",{parentName:"h3"},"metals/didFocusTextDocument")),(0,o.kt)("p",null,"The Metals did focus notification is sent from the client to the server when the\neditor changes focus to a new text document. Unlike ",(0,o.kt)("inlineCode",{parentName:"p"},"textDocument/didOpen"),", the\ndid focus notification is sent even when the text document is already open."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/XjTtAZK.gif",alt:"Metals did focus"})),(0,o.kt)("p",null,"Observe that the compilation error appears as soon as ",(0,o.kt)("inlineCode",{parentName:"p"},"UserTest.scala")," is\nfocused even if the text document was already open before. The LSP\n",(0,o.kt)("inlineCode",{parentName:"p"},"textDocument/didOpen")," notification is only sent the first time a document so it\nis not possible for the language server to re-trigger compilation when moves\nfocus back to ",(0,o.kt)("inlineCode",{parentName:"p"},"UserTest.scala")," that depends on APIs defined in ",(0,o.kt)("inlineCode",{parentName:"p"},"User.scala"),"."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Notification"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"method: ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/didFocusTextDocument")),(0,o.kt)("li",{parentName:"ul"},"params: ",(0,o.kt)("inlineCode",{parentName:"li"},"string"),", the URI of the document where the focused was moved to.")),(0,o.kt)("h3",{id:"metalsexecuteclientcommand"},(0,o.kt)("inlineCode",{parentName:"h3"},"metals/executeClientCommand")),(0,o.kt)("p",null,"The Metals execute client command is sent from the server to the client to\ntrigger an action inside the editor. This notification is a copy of the\n",(0,o.kt)("inlineCode",{parentName:"p"},"workspace/executeCommand")," except"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"execute client command is a notification, not a request"),(0,o.kt)("li",{parentName:"ul"},"execute client command is initiated from the server, not the client")),(0,o.kt)("p",null,"See ",(0,o.kt)("a",{parentName:"p",href:"https://scalameta.org/metals/docs/integrations/new-editor#metals-client-commands"},"Metals client\ncommands"),"\nfor the list of supported client commands."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Notification"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"method: ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/executeClientCommand")),(0,o.kt)("li",{parentName:"ul"},"params: ",(0,o.kt)("inlineCode",{parentName:"li"},"ExecuteCommandParams"),", as defined in LSP.")),(0,o.kt)("h3",{id:"metalsinputbox"},(0,o.kt)("inlineCode",{parentName:"h3"},"metals/inputBox")),(0,o.kt)("p",null,"The Metals input box request is sent from the server to the client to let the\nuser provide a string value for a given prompt. Unlike\n",(0,o.kt)("inlineCode",{parentName:"p"},"window/showMessageRequest"),", the ",(0,o.kt)("inlineCode",{parentName:"p"},"metals/inputBox")," request allows the user to\nprovide a custom response instead of picking a pre-selected value."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Request"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"method: ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/inputBox")),(0,o.kt)("li",{parentName:"ul"},"params: ",(0,o.kt)("inlineCode",{parentName:"li"},"MetalsInputBoxParams")," defined as follows. Note, matches\n",(0,o.kt)("a",{parentName:"li",href:"https://code.visualstudio.com/api/references/vscode-api#InputBoxOptions"},(0,o.kt)("inlineCode",{parentName:"a"},"InputBoxOptions")),"\nin the Visual Studio Code API:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"export interface MetalsInputBoxParams {\n  /**\n   * The value to prefill in the input box.\n   */\n  value?: string;\n  /**\n   * The text to display underneath the input box.\n   */\n  prompt?: string;\n  /**\n   * An optional string to show as place holder in the input box to guide the user what to type.\n   */\n  placeHolder?: string;\n  /**\n   * Set to `true` to show a password prompt that will not show the typed value.\n   */\n  password?: boolean;\n  /**\n   * Set to `true` to keep the input box open when focus moves to another part of the editor or to another window.\n   */\n  ignoreFocusOut?: boolean;\n}\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"result: ",(0,o.kt)("inlineCode",{parentName:"li"},"MetalsInputBoxResult")," defined as follows:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"export interface MetalsInputBoxResult {\n  value?: string;\n  cancelled?: boolean;\n}\n")),(0,o.kt)("h3",{id:"metalsquickpick"},(0,o.kt)("inlineCode",{parentName:"h3"},"metals/quickPick")),(0,o.kt)("p",null,"The Metals quick pick request is sent from the server to the client to let the\nuser provide a string value by picking one out of a number of given options. It\nis similar to ",(0,o.kt)("inlineCode",{parentName:"p"},"window/showMessageRequest"),", but the ",(0,o.kt)("inlineCode",{parentName:"p"},"metals/quickPick")," request\nhas richer parameters, that can be used to filter items to pick, like\n",(0,o.kt)("inlineCode",{parentName:"p"},"description")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"detail"),"."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Request"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"method: ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/quickPick")),(0,o.kt)("li",{parentName:"ul"},"params: ",(0,o.kt)("inlineCode",{parentName:"li"},"MetalsQuickInputParams")," defined as follows. It partially matches\n",(0,o.kt)("a",{parentName:"li",href:"https://code.visualstudio.com/api/references/vscode-api#QuickPickOptions"},(0,o.kt)("inlineCode",{parentName:"a"},"QuickPickOptions")),"\nin the Visual Studio Code API, but it also contains ",(0,o.kt)("inlineCode",{parentName:"li"},"items")," of\n",(0,o.kt)("a",{parentName:"li",href:"https://code.visualstudio.com/api/references/vscode-api#QuickPickItem"},(0,o.kt)("inlineCode",{parentName:"a"},"MetalsQuickPickItem")),",\nwhich, in it's turn, partially matches ",(0,o.kt)("inlineCode",{parentName:"li"},"QuickPickItem"),", but these interfaces\ndo not contain options for picking many items:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"export interface MetalsQuickPickParams {\n  /**\n   * An array of items that can be selected from.\n   */\n  items: MetalsQuickPickItem[];\n  /**\n   * An optional flag to include the description when filtering the picks.\n   */\n  matchOnDescription?: boolean;\n  /**\n   * An optional flag to include the detail when filtering the picks.\n   */\n  matchOnDetail?: boolean;\n  /**\n   * An optional string to show as place holder in the input box to guide the user what to pick on.\n   */\n  placeHolder?: string;\n  /**\n   * Set to `true` to keep the picker open when focus moves to another part of the editor or to another window.\n   */\n  ignoreFocusOut?: boolean;\n}\n\nexport interface MetalsQuickPickItem {\n  /**\n   * An id for this items that should be return as a result of the picking.\n   */\n  id: string;\n  /**\n   * A human readable string which is rendered prominent.\n   */\n  label: string;\n  /**\n   * A human readable string which is rendered less prominent.\n   */\n  description?: string;\n  /**\n   * A human readable string which is rendered less prominent.\n   */\n  detail?: string;\n  /**\n   * Always show this item.\n   */\n  alwaysShow?: boolean;\n}\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"result: ",(0,o.kt)("inlineCode",{parentName:"li"},"MetalsQuickPickResult")," defined as follows:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"export interface MetalsQuickPickResult {\n  itemId?: string;\n  cancelled?: boolean;\n}\n")),(0,o.kt)("h3",{id:"metalswindowstatedidchange"},(0,o.kt)("inlineCode",{parentName:"h3"},"metals/windowStateDidChange")),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"metals/windowStateDidChange")," notification is sent from the client to the\nserver to indicate whether the editor application window is focused or not. When\nthe editor window is not focused, Metals tries to avoid triggering expensive\ncomputation in the background such as compilation."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Notification"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"method: ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/windowStateDidChange")),(0,o.kt)("li",{parentName:"ul"},"params: ",(0,o.kt)("inlineCode",{parentName:"li"},"WindowStateDidChangeParams")," defined as follows:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"interface WindowStateDidChangeParams( {\n  /** If true, the editor application window is focused. False, otherwise. */\n  focused: boolean;\n}\n")),(0,o.kt)("h3",{id:"metalsopenwindow"},(0,o.kt)("inlineCode",{parentName:"h3"},"metals/openWindow")),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"metals/openWindow")," params are used with the New Scala Project\nfunctionality. After the new project has been created, if the editor has the\nability to open the project in a new window then these params are used with the\nthe ",(0,o.kt)("inlineCode",{parentName:"p"},"metals-open-folder")," command."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"interface MetalsOpenWindowParams {\n  /** Location of the newly created project. */\n  uri: string;\n  /** Whether or not to open the project in a new window. */\n  openNewWindow: boolean;\n}\n")),(0,o.kt)("h3",{id:"metalsfindtextindependencyjars"},(0,o.kt)("inlineCode",{parentName:"h3"},"metals/findTextInDependencyJars")),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"FindTextInDependencyJars")," request is sent from the client to the server to perform a search though files in the classpath\nincluding binary and sources jars. In response it returns a standard list of ",(0,o.kt)("inlineCode",{parentName:"p"},"Location")," from the ",(0,o.kt)("a",{parentName:"p",href:"https://microsoft.github.io/language-server-protocol/specification#location"},"LSP spec"),"."),(0,o.kt)("p",null,"In case if this enpoint was called with empty ",(0,o.kt)("inlineCode",{parentName:"p"},"query.pattern")," or empty ",(0,o.kt)("inlineCode",{parentName:"p"},"options.include")," server sends ",(0,o.kt)("a",{parentName:"p",href:"https://scalameta.org/metals/docs/integrations/new-editor#metalsinputbox"},(0,o.kt)("inlineCode",{parentName:"a"},"metals/inputBox")),"\nrequest to the client to obtain these values."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Request"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"method: ",(0,o.kt)("inlineCode",{parentName:"li"},"metals/findTextInDependecyJars")),(0,o.kt)("li",{parentName:"ul"},"params: ",(0,o.kt)("inlineCode",{parentName:"li"},"FindTextInDependencyJarsRequest")," defined as follows.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"/**\n * Currenly, only `pattern` field is used for search.\n * See: https://github.com/scalameta/metals/issues/3234\n */ \ninterface TextSearchQuery {\n    /**\n         * The text pattern to search for.\n         */\n    pattern?: string;\n    /**\n         * Whether or not `pattern` should be interpreted as a regular expression.\n         */\n    isRegExp?: boolean;\n    /**\n         * Whether or not the search should be case-sensitive.\n         */\n    isCaseSensitive?: boolean;\n    /**\n         * Whether or not to search for whole word matches only.\n         */\n    isWordMatch?: boolean;\n}\n\ninterface FindTextInFilesOptions {\n    /** Include file filter. Example: `*.conf` */\n    include?: string;\n    /** Exclude file filter. Example: `*.conf` */\n    exclude?: string;\n}\n\ninterface FindTextInDependencyJarsRequest(\n    options?: FindTextInFilesOptions;\n    query: TextSearchQuery\n)\n")),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Response"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"result: ",(0,o.kt)("inlineCode",{parentName:"li"},"Location[]"))))}m.isMDXComponent=!0}}]);